function lang_translate(a){translate=new Array();lang_es(translate);lang_en(translate);return translate[a]}function lang_loadtags(){$("div.T_AJUSTS").html(T.AJUSTS);$("div.T_ANNOTATE").html(T.ANNOTATE);$("div.T_DIARY").html(T.DIARY);$("div.T_MEASURES").html(T.MEASURES);$("div.T_BOLUS").html(T.BOLUS);$("div.T_RATIONS").html(T.RATIONS);$("div.T_BASALS").html(T.BASALS);$("div.T_MEAL").html(T.MEAL);$("div.T_MEASURES_PER_MEAL").html(T.MEASURES_PER_MEAL);$("div.T_MEASURES_PER_HOUR").html(T.MEASURES_PER_HOUR);$("div.T_RANGES_PER_HOUR").html(T.RANGES_PER_HOUR);$("div.T_BOLUS_PER_MEAL").html(T.BOLUS_PER_MEAL);$("div.T_BOLUS_PER_HOUR").html(T.BOLUS_PER_HOUR);$("div.T_RATIONS_PER_MEAL").html(T.RATIONS_PER_MEAL);$("div.T_RATIONS_PER_HOUR").html(T.RATIONS_PER_HOUR);$("div.T_BASALS_TYPES").html(T.BASALS_TYPES);$("div.T_BASALS_ACT").html(T.BASALS_ACT);$("div.T_CONFIG").html(T.CONFIG);$("div.T_CONNECTION").html(T.CONNECTION);$("div.T_CMD").html(T.CMD);$("div.T_MENU").html(T.MENU);$("div.T_VOICE").html(T.VOICE);$("div.T_IDIOM").html(T.IDIOM);$("div.T_IDENTITY").html(T.IDENTITY);$("div.T_REMOTE").html(T.REMOTE);$("div.T_SYNC").html(T.SYNC);$("div.T_BDEFINE").html(T.BDEFINE);$("div.T_BACTIVATE").html(T.BACTIVATE);$("div.T_PATTERN").html(T.PATTERN);$("div.T_PERCENTAGE").html(T.PERCENTAGE);$("div.T_INSTANT").html(T.INSTANT);$("div.T_AMD_HM").html(T.AMD_HM);$("div.T_N_SECTIONS").html(T.N_SECTIONS);$("div.T_ABOUT").html(T.ABOUT);$("div.T_QUICK").html(T.QUICK);$("div.T_SITUATION").html(T.SITUATION);$("div.T_ANTES_COMER_PUNTOS").html(T.ANTES_COMER_PUNTOS);$("div.T_MEASURE2").html(T.MEASURE2);$("div.T_UNITS").html(T.UNITS);$("div.T_BEGIN").html(T.BEGIN);$("div.T_END").html(T.END);$("div.T_RATIONS").html(T.RATIONS);$("div.T_DESCRIPTION").html(T.DESCRIPTION);$("div.T_ENSALADA_PUNTOS").html(T.ENSALADA_PUNTOS);$("div.T_IMAGE").html(T.IMAGE);$("div.T_PHOTO").html(T.PHOTO);$("div.T_OTHERS").html(T.OTHERS);$("div.T_EVENT").html(T.EVENT);$("div.T_EJERCICIO_PUNTOS").html(T.EJERCICIO_PUNTOS);$("div.T_TYPES").html(T.TYPES);$("div.T_NADAR_PUNTOS").html(T.NADAR_PUNTOS);$("div.T_INTENSITY").html(T.INTENSITY);$("div.T_AVERAGE").html(T.AVERAGE);$("div.T_BNA").html(T.BNA);$("div.T_DEFINE").html(T.DEFINE);$("div.T_ACTIVATE").html(T.ACTIVATE);$("div.T_STATUS").html(T.STATUS);$("div.T_TOTALPERDAY").html(T.TOTALPERDAY);$("div.T_LOCATION").html(T.LOCATION);$("div.T_EXIT").html(T.EXIT);$("div.T_PERSONAL").html(T.PERSONAL);$("div.T_DEVICE").html(T.DEVICE);$("div.T_AFTERMEAL").html(T.AFTERMEAL);$("div.T_DAYSTARTAT").html(T.DAYSTARTAT);$("div.T_MEASUREGOALS").html(T.MEASUREGOALS);$("div.T_SELECT").html(T.SELECT);$("div.T_CLOSE").html(T.CLOSE);$("div.T_ADD").html(T.ADD);$("div.T_ADDPP").html(T.ADDPP);$("div.T_MODIFY").html(T.MODIFY);$("div.T_UPDATE").html(T.UPDATE);$("div.T_VIEW").html(T.VIEW);$("div.T_CAMERA").html(T.CAMERA);$("div.T_GALLERY").html(T.GALLERY);$("div.T_ACTIVATE2").html(T.ACTIVATE2);$("div.T_SYNC2").html(T.SYNC2);$("div.T_TABLE_H").html(T.TABLE_H);$("div.T_TABLE_V").html(T.TABLE_V);$("div.T_TABLE_R").html(T.TABLE_R);$("div.T_HORIZONTAL").html(T.HORIZONTAL);$("div.T_VERTICAL").html(T.VERTICAL);$("div.T_SUMMARY").html(T.SUMMARY);$("div.T_TABLES").html(T.TABLES);$("div.T_GRAPHS").html(T.GRAPHS);$("div.T_1_DAY").html(T["1_DAY"]);$("div.T_2_DAYS").html(T["2_DAYS"]);$("div.T_3_DAYS").html(T["3_DAYS"]);$("div.T_5_DAYS").html(T["5_DAYS"]);$("div.T_1_WEEK").html(T["1_WEEK"]);$("div.T_2_WEEKS").html(T["2_WEEKS"]);$("div.T_1_MONTH").html(T["1_MONTH"]);$("div.T_NONE").html(T.NONE);$("div.T_TRACE").html(T.TRACE);$("div.T_INTERCHANGE").html(T.INTERCHANGE);$("div.T_VERSION").html(T.VERSION);$("div.T_AUTHOR").html(T.AUTHOR);$("div.T_LICENCE").html(T.LICENCE);$("div.T_REPOSITORY").html(T.REPOSITORY);$("div.T_IMPORT").html(T.IMPORT);$("div.T_EXPORT").html(T.EXPORT);$("div.T_LOGIN").html(T.LOGIN);$("div.T_PASSWORD").html(T.PASSWORD);$("div.T_LASTSYNC").html(T.LASTSYNC)}function lang_es(a){a.es=new Array();a.es["AJUSTS"]="Ajustes";a.es["ANNOTATE"]="Apuntar";a.es["BASAL"]="Basal";a.es["BASALS"]="Basales";a.es["BDEFINE"]="Definir basal";a.es["BACTIVATE"]="Activar basal";a.es["BOLUS"]="Bolus";a.es["MEAL"]="Comida";a.es["MEALS"]="Comidas";a.es["CONFIG"]="Configurar";a.es["CONNECTION"]="Conexi&oacute;n";a.es["SQUARE"]="Cuadrado";a.es["STATS"]="Estad&iacute;sticas";a.es["DIARY"]="Diario";a.es["DIARY_DAY"]="Hoy";a.es["DIARY_WEEK"]="Semana";a.es["DIARY_MONTH"]="Mes";a.es["DIARY_MONTH1"]="Mes (ancho)";a.es["DIARY_MONTH2"]="Mes (alto)";a.es["DUAL"]="Dual";a.es["IDIOM"]="Idioma";a.es["INSTALL"]="Instalar";a.es["IDENTITY"]="Identidad";a.es["REMOTE"]="Acceso remoto";a.es["SYNC"]="Sincronizaci&oacute;n";a.es["MEASURE"]="Medida";a.es["MEASURES"]="Medidas";a.es["NORMAL"]="Normal";a.es["OTHERS"]="Otros";a.es["QUICK"]="Medida+Bolo+Comida";a.es["VOICE"]="Voz";a.es["ABOUT"]="Acerca de";a.es["CMD"]="Mandato";a.es["MENU"]="Men&uacute;";a.es["LOCATION"]="Localizaci&oacute;n";a.es["EXIT"]="Salir";a.es["PERSONAL"]="Personal";a.es["DEVICE"]="Dispositivo";a.es["AMD_HM"]="a&ntilde;o-mes-d&iacute;a h:m";a.es["ANTES_COMER_PUNTOS"]="antes comida, ...";a.es["ENSALADA_PUNTOS"]="ensalada, ...";a.es["OPCIONAL"]="(opcional)";a.es["EJERCICIO_PUNTOS"]="ejercicio, enfermedad, ...";a.es["NADAR_PUNTOS"]="nadar, andar, ...";a.es["BNA"]="baja, normal, alta";a.es["MEDIDA120_PUNTOS"]="apuntar medida 120, apuntar bolo dual 5 30, apuntar comida 5 ensalada, ...";a.es["UNKNOWN_CMD"]="Mandato de voz desconocido";a.es["PHOTO"]="Fotograf&iacute;a...";a.es["NOTE"]="Apunte";a.es["BOLUS_PER_MEAL"]="Por comida";a.es["BOLUS_PER_HOUR"]="Por hora";a.es["DESCRIPTION"]="Descripci&oacute;n";a.es["EVENT"]="Evento";a.es["END"]="Fin";a.es["SITUATION"]="Situaci&oacute;n";a.es["IMAGE"]="Imagen";a.es["BEGIN"]="Inicio";a.es["INSTANT"]="Instante";a.es["INTENSITY"]="Intensidad";a.es["AVERAGE"]="Media";a.es["MEASURES_PER_MEAL"]="Por comida";a.es["MEASURES_PER_HOUR"]="Por hora";a.es["MEASURE2"]="Medida";a.es["PATTERN"]="Patr&oacute;n";a.es["PERCENTAGE"]="Porcentaje";a.es["RATIONS"]="Raciones";a.es["RATIONS_PER_MEAL"]="Por comida";a.es["RATIONS_PER_HOUR"]="Por hora";a.es["RANGES_PER_HOUR"]="Nube";a.es["CARB_RATIO"]="Ratio carbohidrato";a.es["TYPES"]="Tipo";a.es["BASALS_TYPES"]="Tipos definidos";a.es["BASALS_ACT"]="Activaciones";a.es["N_SECTIONS"]="# tramos";a.es["UNITS"]="Unidades";a.es["PLATFORM"]="Plataforma";a.es["COLORS"]="Colores";a.es["DEFINE"]="Definir";a.es["ACTIVATE"]="Activar";a.es["STATUS"]="Estado";a.es["TOTALPERDAY"]="Total/D&iacute;a";a.es["AFTERMEAL"]="Despu&eacute;s de comer a las...";a.es["DAYSTARTAT"]="El d&iacute;a comienza a las...";a.es["MEASUREGOALS"]="Objetivo de medidas...";a.es["SELECT"]="seleccionar";a.es["CLOSE"]="cerrar";a.es["ADDORUPDATE"]="a&ntilde;adir/actualizar";a.es["ADD"]="a&ntilde;adir";a.es["ADDPP"]="a&ntilde;adir++";a.es["UPDATE"]="actualizar";a.es["SEND"]="enviar";a.es["MODIFY"]="cambiar";a.es["VIEW"]="visualizar";a.es["CAMERA"]="c&aacute;mara";a.es["GALLERY"]="galer&iacute;a";a.es["ACTIVATE2"]="activar";a.es["SYNC2"]="sincronizar";a.es["UPDATED"]="actualizado";a.es["MONDAY"]="L";a.es["TUESDAY"]="M";a.es["WEDNESDAY"]="X";a.es["THURSDAY"]="J";a.es["FRIDAY"]="V";a.es["SATURDAY"]="S";a.es["SUNDAY"]="D";a.es["DAY"]="D&iacute;a";a.es["WEEK"]="Semana";a.es["MONTH"]="Mes";a.es["TABLE_H"]="Tabla (horizontal)";a.es["TABLE_V"]="Tabla (vertical)";a.es["TABLE_R"]="Tabla resumen";a.es["HORIZONTAL"]="Horizontal";a.es["VERTICAL"]="Vertical";a.es["SUMMARY"]="Resumen";a.es["TABLES"]="Tabla";a.es["GRAPHS"]="Gr&aacute;ficos";a.es["1_DAY"]="1 d&iacute;a";a.es["2_DAYS"]="2 d&iacute;as";a.es["3_DAYS"]="3 d&iacute;as";a.es["5_DAYS"]="5 d&iacute;as";a.es["1_WEEK"]="1 semana";a.es["2_WEEKS"]="2 semanas";a.es["1_MONTH"]="1 mes";a.es["NONE"]="Nada";a.es["TRACE"]="Seguimiento";a.es["INTERCHANGE"]="Intercambio";a.es["VERSION"]="Versi&oacute;n";a.es["AUTHOR"]="Autor";a.es["LICENCE"]="Licencia";a.es["REPOSITORY"]="Repositorio";a.es["IMPORT"]="Importar";a.es["EXPORT"]="Exportar";a.es["LOGIN"]="Usuario";a.es["PASSWORD"]="Clave";a.es["LASTSYNC"]="&Uacute;ltima sincro.";return a}function lang_en(a){a.en=new Array();a.en["AJUSTS"]="Ajusts";a.en["ANNOTATE"]="Annotate";a.en["BASAL"]="Basal";a.en["BASALS"]="Basals";a.en["BDEFINE"]="Basal definition";a.en["BACTIVATE"]="Basal activation";a.en["BOLUS"]="Bolus";a.en["MEAL"]="Meal";a.en["MEALS"]="Meals";a.en["CONFIG"]="Configure";a.en["CONNECTION"]="Connection";a.en["SQUARE"]="Square";a.en["STATS"]="Stats";a.en["DIARY"]="Diary";a.en["DIARY_DAY"]="Today";a.en["DIARY_WEEK"]="Week";a.en["DIARY_MONTH"]="Month";a.en["DIARY_MONTH1"]="Month (wide)";a.en["DIARY_MONTH2"]="Month (high)";a.en["DUAL"]="Dual";a.en["IDIOM"]="Language";a.en["INSTALL"]="Install";a.en["IDENTITY"]="Identity";a.en["REMOTE"]="Remote";a.en["SYNC"]="Synchronization";a.en["MEASURE"]="Measure";a.en["MEASURES"]="Measures";a.en["NORMAL"]="Normal";a.en["OTHERS"]="Others";a.en["QUICK"]="Measure+Bolus+Meal";a.en["VOICE"]="Voice";a.en["ABOUT"]="About";a.en["CMD"]="Command";a.en["MENU"]="Menu";a.en["LOCATION"]="Location";a.en["EXIT"]="Exit";a.en["PERSONAL"]="Personal";a.en["DEVICE"]="Device";a.en["AMD_HM"]="year-month-day h:m";a.en["ANTES_COMER_PUNTOS"]="before meal, ...";a.en["ENSALADA_PUNTOS"]="salad, ...";a.en["OPCIONAL"]="(optional)";a.en["EJERCICIO_PUNTOS"]="exercice, illness, ...";a.en["NADAR_PUNTOS"]="to swim, walk, ...";a.en["BNA"]="low, normal, high";a.en["MEDIDA120_PUNTOS"]="annotate measure 120, annotate dual bolus 5 30, annotate meal 5 salad, ...";a.en["UNKNOWN_CMD"]="Unknowd voice command";a.en["PHOTO"]="Photo...";a.en["NOTE"]="Note";a.en["BOLUS_PER_MEAL"]="Per meal";a.en["BOLUS_PER_HOUR"]="Per hour";a.en["DESCRIPTION"]="Description";a.en["EVENT"]="Event";a.en["END"]="End";a.en["SITUATION"]="Situation";a.en["IMAGE"]="Image";a.en["BEGIN"]="Begin";a.en["INSTANT"]="Instant";a.en["INTENSITY"]="Intensity";a.en["AVERAGE"]="Average";a.en["MEASURES_PER_MEAL"]="Per meal";a.en["MEASURES_PER_HOUR"]="Per hour";a.en["MEASURE2"]="Measure";a.en["PATTERN"]="Pattern";a.en["PERCENTAGE"]="Percentage";a.en["RATIONS"]="Rations";a.en["RATIONS_PER_MEAL"]="Per meal";a.en["RATIONS_PER_HOUR"]="Per hour";a.en["RANGES_PER_HOUR"]="Measure ranges per hour";a.en["CARB_RATIO"]="Carbohidrate ratio";a.en["TYPES"]="Type";a.en["BASALS_TYPES"]="Defined basals";a.en["BASALS_ACT"]="Basals activations";a.en["N_SECTIONS"]="# sections";a.en["UNITS"]="Units";a.en["PLATFORM"]="Platform";a.en["COLORS"]="Colors";a.en["DEFINE"]="Define";a.en["ACTIVATE"]="Activate";a.en["STATUS"]="Status";a.en["TOTALPERDAY"]="Total/Day";a.en["AFTERMEAL"]="After meal at...";a.en["DAYSTARTAT"]="Day start at...";a.en["MEASUREGOALS"]="Measure goals...";a.en["SELECT"]="select";a.en["CLOSE"]="close";a.en["ADDORUPDATE"]="add/update";a.en["ADD"]="add";a.en["ADDPP"]="add++";a.en["UPDATE"]="update";a.en["SEND"]="send";a.en["MODIFY"]="modify";a.en["VIEW"]="view";a.en["CAMERA"]="camera";a.en["GALLERY"]="gallery";a.en["ACTIVATE2"]="activate";a.en["SYNC2"]="sync";a.en["UPDATED"]="updated";a.en["MONDAY"]="M";a.en["TUESDAY"]="T";a.en["WEDNESDAY"]="W";a.en["THURSDAY"]="T";a.en["FRIDAY"]="F";a.en["SATURDAY"]="s";a.en["SUNDAY"]="S";a.en["DAY"]="Day";a.en["WEEK"]="Week";a.en["MONTH"]="Month";a.en["TABLE_H"]="Table (horizontal)";a.en["TABLE_V"]="Table (vertical)";a.en["TABLE_R"]="Table (summary)";a.en["HORIZONTAL"]="Horizontal";a.en["VERTICAL"]="Vertical";a.en["SUMMARY"]="Summary";a.en["TABLES"]="Table";a.en["GRAPHS"]="Graphs";a.en["1_DAY"]="1 Day";a.en["2_DAYS"]="2 Day";a.en["3_DAYS"]="3 Day";a.en["5_DAYS"]="5 Day";a.en["1_WEEK"]="1 Week";a.en["2_WEEKS"]="2 Week";a.en["1_MONTH"]="1 Month";a.en["NONE"]="None";a.en["TRACE"]="Tracing";a.en["INTERCHANGE"]="Interchange";a.en["VERSION"]="Version";a.en["AUTHOR"]="Author";a.en["LICENCE"]="Licence";a.en["REPOSITORY"]="Repository";a.en["IMPORT"]="Import";a.en["EXPORT"]="Export";a.en["LOGIN"]="Login";a.en["PASSWORD"]="Password";a.en["LASTSYNC"]="Last sync";return a}var em={};em.dbsize=0;em.db=null;em.open=function(){em.dbsize=4*1024*1024;em.db=html5sql.openDatabase("em","Event Monitor",em.dbsize)};em.close=function(){em.dbsize=0;em.db=null};function webdb_execute(b,g,f,a){var e=new Date();if(typeof f==="undefined"){f=function(){var h=new Date();em.executiontime=(h-e)/1000;console.log("Done. ("+em.executiontime+" seconds)")}}if(typeof a==="undefined"){a=function(n,l){var h=new Date();em.executiontime=(h-e)/1000;console.error("Error: "+n.message+". ("+em.executiontime+" seconds)")}}em.open();html5sql.process(g,f,a)}function webdb_select2asocArray_2(b,e){em.open();var a=new Array();html5sql.process("SELECT * FROM "+b+" WHERE id="+e,function(l,g,h){for(var f=0;f<h.length;f++){for(attr in rowArray[f]){a[attr]=h[f][attr]}}},function(f,g){});em.close();return a}function webdb_select2asocArray_3(b,e,a){em.open();html5sql.process("SELECT * FROM "+b+" WHERE id="+e,function(l,g,h){for(var f=0;f<h.length;f++){for(attr in rowArray[f]){a[attr]=h[f][attr]}}},function(f,g){});em.close();return a}function db_asocArray2insert(g,a,f){insertar=" INSERT INTO "+g+" ";insertar_nombres="(";insertar_valores=" VALUES (";last=0;var e=[];for(key in a){if(f.indexOf(key)==-1){e.push(key);last++}}for(var b=0;b<last;b++){key=e[b];value=a[key];insertar_nombres+=key;insertar_valores+="'"+value+"'";if(b!=(last-1)){insertar_nombres+=", ";insertar_valores+=", "}}insertar_nombres+=")";insertar_valores+=")";insertar+=insertar_nombres+insertar_valores;return insertar}function db_asocArray2update(h,a,g){actualizar=" UPDATE "+h+" SET ";last=0;var f=[];for(key in a){if(g.indexOf(key)==-1){f.push(key);last++}}for(var e=0;e<last;e++){key=f[e];value=a[key];actualizar+=" "+key+"='"+value+"'";if(e!=(last-1)){actualizar+=", "}}for(var b=0;b<g.length;b++){if(0==b){actualizar+=" WHERE "+g[b]+"='"+a[g[b]]+"'"}else{actualizar+=" AND   "+g[b]+"='"+a[g[b]]+"'"}}return actualizar}function db_asocArray2insertorreplace(g,a,f){insertar=" INSERT OR REPLACE INTO "+g+" ";insertar_nombres="(";insertar_valores=" VALUES (";last=0;var e=[];for(key in a){if(f.indexOf(key)==-1){e.push(key);last++}else{if(a[key]!=-1){e.push(key);last++}}}for(var b=0;b<last;b++){key=e[b];value=a[key];insertar_nombres+=key;insertar_valores+="'"+value+"'";if(b!=(last-1)){insertar_nombres+=", ";insertar_valores+=", "}}insertar_nombres+=")";insertar_valores+=")";insertar+=insertar_nombres+insertar_valores;return insertar}function db_asocArray2replace(g,a,f){insertar=" REPLACE INTO "+g+" ";insertar_nombres="(";insertar_valores=" VALUES (";last=0;var e=[];for(key in a){if(f.indexOf(key)==-1){e.push(key);last++}}for(var b=0;b<last;b++){key=e[b];value=a[key];insertar_nombres+=key;insertar_valores+="'"+value+"'";if(b!=(last-1)){insertar_nombres+=", ";insertar_valores+=", "}}insertar_nombres+=")";insertar_valores+=")";insertar+=insertar_nombres+insertar_valores;return insertar}function db_asocArray2delete(f,a,e){borrar=" DELETE FROM "+f;for(var b=0;b<e.length;b++){if(0==b){borrar+=" WHERE "+e[b]+"='"+a[e[b]]+"'"}else{borrar+=" AND   "+e[b]+"='"+a[e[b]]+"'"}}return borrar}function db_asocArray2list(b,a){listar=" SELECT * FROM "+b;return listar}function db_execute(b,f,e,a){if(""==b){webdb_execute(b,f,e,a)}else{mysql_execute(b,f,e,a)}}function db_importFromFile(e,a,f,b){$.get(a,function(g){db_execute(e,g,f,b)})}function db_select2asocArray_2(a,b,e){if(""==a){webdb_select2asocArray_2(a,b,e)}else{mysql_select2asocArray_2(a,b,e)}}function db_select2asocArray_3(a,e,f,b){if(""==a){webdb_select2asocArray_3(a,e,f,b)}else{mysql_select2asocArray_3(a,e,f,b)}}function db_asocArray2insertorupdate(b,f,a,e){if(""==b){return db_asocArray2insertorreplace(f,a,e)}else{return db_asocArray2replace(f,a,e)}}function db_webdb2js_aux(b,a,f,e,g){html5sql.process(a[f],function(s,q,l){if(f<(a.length-1)){db_webdb2js_aux(b,a,f+1,e,g)}for(var p=0;p<q.rows.length;p++){if(q.rows.item(p).rt=="basaldef"){if(typeof e.basaldef==="undefined"){e.basaldef=new Array()}e.basaldef.push({id:q.rows.item(p).id,pattern:q.rows.item(p).pattern,neltos:q.rows.item(p).neltos,segments:q.rows.item(p).segments,user:q.rows.item(p).user,sync:q.rows.item(p).sync,device:q.rows.item(p).device});continue}if(q.rows.item(p).rt=="last_basalact"){js_record={id:q.rows.item(p).id,pattern:q.rows.item(p).pattern,neltos:q.rows.item(p).neltos,segments:q.rows.item(p).segments,percentage:q.rows.item(p).percentage,start:q.rows.item(p).start,user:q.rows.item(p).user,sync:q.rows.item(p).sync,device:q.rows.item(p).device};if(typeof e.basalact==="undefined"){e.basalact=new Array()}e.basalact.push(js_record);continue}dt=new XDate(q.rows.item(p).start);var n=("0"+(dt.getMonth()+1)).slice(-2);var r=("0"+dt.getDate()).slice(-2);var h=parseInt("1"+n+"1"+r,10);if($.inArray(h,b)==-1){continue}i_h=dt.toUTCString("HH:mm");i_d=dt.toUTCString("yyyy-MM-dd");if(typeof e[i_d]==="undefined"){e[i_d]=new Array()}if(typeof e[i_d][i_h]==="undefined"){e[i_d][i_h]=new Array()}if(q.rows.item(p).rt=="bolus"){e[i_d][i_h]["bolus"]={id:q.rows.item(p).id,name:q.rows.item(p).name,type:q.rows.item(p).type,units:q.rows.item(p).units,percentage:q.rows.item(p).percentage,start:q.rows.item(p).start,stop:q.rows.item(p).stop,user:q.rows.item(p).user,sync:q.rows.item(p).sync,device:q.rows.item(p).device};continue}if(q.rows.item(p).rt=="meal"){e[i_d][i_h]["meal"]={id:q.rows.item(p).id,name:q.rows.item(p).name,tag:q.rows.item(p).tag,image:q.rows.item(p).image,measure:q.rows.item(p).measure,start:q.rows.item(p).start,stop:q.rows.item(p).stop,user:q.rows.item(p).user,sync:q.rows.item(p).sync,device:q.rows.item(p).device};continue}if(q.rows.item(p).rt=="measure"){e[i_d][i_h]["measure"]={id:q.rows.item(p).id,name:q.rows.item(p).name,measure:q.rows.item(p).measure,start:q.rows.item(p).start,stop:q.rows.item(p).stop,user:q.rows.item(p).user,sync:q.rows.item(p).sync,device:q.rows.item(p).device};continue}if(q.rows.item(p).rt=="event"){e[i_d][i_h]["event"]={id:q.rows.item(p).id,name:q.rows.item(p).name,event:q.rows.item(p).event,type:q.rows.item(p).type,measure:q.rows.item(p).measure,start:q.rows.item(p).start,stop:q.rows.item(p).stop,user:q.rows.item(p).user,image:q.rows.item(p).image,sync:q.rows.item(p).sync,device:q.rows.item(p).device};continue}if(q.rows.item(p).rt=="basalact"){js_record={id:q.rows.item(p).id,pattern:q.rows.item(p).pattern,neltos:q.rows.item(p).neltos,segments:q.rows.item(p).segments,percentage:q.rows.item(p).percentage,start:q.rows.item(p).start,user:q.rows.item(p).user,sync:q.rows.item(p).sync,device:q.rows.item(p).device};e[i_d][i_h]["basalact"]=js_record;if(typeof e.basalact==="undefined"){e.basalact=new Array()}e.basalact.push(js_record);continue}}if(f==(a.length-1)){g()}},function(h,l){console.error("Error: "+h.message+".")})}function db_webdb2js(l,e,r){vector_details=new Array();html5sql.openDatabase("em","Event Monitor",4*1024*1024);qs=new Array();var b=new Array();var p=1;for(year in l){for(month in l[year]){var q=32;for(day in l[year][month]){var a=parseInt(day);if(a<q){q=a}var n=("0"+month).slice(-2);var h=("0"+day).slice(-2);var s=parseInt("1"+n+"1"+h,10);b.push(s)}var g=("0"+month).slice(-2);var f=("0"+q).slice(-2);qs.push("SELECT 'bolus' as 'rt',* FROM bolus  WHERE strftime('%Y-%m',start)='"+year+"-"+g+"'  AND   user='"+e+"'  AND   units!=0 ORDER BY start;");qs.push("SELECT 'meal' as 'rt',* FROM meals  WHERE strftime('%Y-%m',start)='"+year+"-"+g+"'  AND   user='"+e+"'  AND   measure!=0 ORDER BY start;");qs.push("SELECT 'measure' as 'rt',* FROM measures  WHERE strftime('%Y-%m',start)='"+year+"-"+g+"'  AND   user='"+e+"'  AND   measure!=0 ORDER BY start;");qs.push("SELECT 'event' as 'rt',* FROM events  WHERE strftime('%Y-%m',start)='"+year+"-"+g+"'  AND   user='"+e+"'  AND   event!='' ORDER BY start;");qs.push("SELECT 'basalact' as 'rt',* FROM basal_activations  WHERE strftime('%Y-%m',start)='"+year+"-"+g+"'  AND   user='"+e+"'  AND   pattern!='' ORDER BY start;");if(1==p){qs.push("SELECT 'last_basalact' as 'rt',* FROM basal_activations  WHERE strftime('%Y-%m-%d',start)<='"+year+"-"+g+"-"+f+"'  AND   user='"+e+"'  AND   pattern!=''  ORDER BY start DESC  LIMIT 1;");qs.push("SELECT 'basaldef' as 'rt',* FROM basal_definitions  WHERE user='"+e+"'  AND   neltos!=0 ORDER BY sync;");p=0}}}db_webdb2js_aux(b,qs,0,vector_details,r);return vector_details}function db_db2js(b,e,a,f){if(""==b){return db_webdb2js(e,a,f)}else{return db_mysql2js(b,e,a,f)}}function db_csv2db(b,a,g){Q=new Array();try{fields=$.csv.toArrays(a,{delimiter:'"',separator:";"})}catch(f){return -1}for(i=0;i<fields.length;i++){switch(fields[i][4]){case"bolus":values_bolus=new Array();values_bolus.id=fields[i][11];values_bolus.name=fields[i][5];values_bolus.type=fields[i][9];values_bolus.units=fields[i][8];values_bolus.percentage=fields[i][10];values_bolus.start=fields[i][6];values_bolus.stop=fields[i][7];values_bolus.user=fields[i][1];values_bolus.sync=fields[i][12];values_bolus.device=fields[i][13];if(0==values_bolus.units){Q.push(db_asocArray2delete("bolus",values_bolus,Array("id","device","user")))}else{Q.push(db_asocArray2insertorupdate(b,"bolus",values_bolus,Array("id")))}break;case"meal":values_meal=new Array();values_meal.id=fields[i][11];values_meal.name=fields[i][5];values_meal.tag=fields[i][9];values_meal.measure=fields[i][8];values_meal.start=fields[i][6];values_meal.stop=fields[i][7];values_meal.user=fields[i][1];values_meal.image=fields[i][10];values_meal.sync=fields[i][12];values_meal.device=fields[i][13];if(0==values_meal.measure){Q.push(db_asocArray2delete("meals",values_meal,Array("id","device","user")))}else{Q.push(db_asocArray2insertorupdate(b,"meals",values_meal,Array("id")))}break;case"measure":values_measure=new Array();values_measure.id=fields[i][9];values_measure.name=fields[i][5];values_measure.measure=fields[i][8];values_measure.start=fields[i][6];values_measure.stop=fields[i][7];values_measure.user=fields[i][1];values_measure.sync=fields[i][10];values_measure.device=fields[i][11];if(0==values_measure.measure){Q.push(db_asocArray2delete("measures",values_measure,Array("id","device","user")))}else{Q.push(db_asocArray2insertorupdate(b,"measures",values_measure,Array("id")))}break;case"event":values_other=new Array();values_other.id=fields[i][11];values_other.name=fields[i][5];values_other.event=fields[i][9];values_other.type=fields[i][10];values_other.measure=fields[i][8];values_other.start=fields[i][6];values_other.stop=fields[i][7];values_other.user=fields[i][1];values_other.image=fields[i][12];values_other.sync=fields[i][13];values_other.device=fields[i][14];if(""==values_other.event){Q.push(db_asocArray2delete("events",values_other,Array("id","device","user")))}else{Q.push(db_asocArray2insertorupdate(b,"events",values_other,Array("id")))}break;case"basalact":values_basal_activation=new Array();values_basal_activation.id=fields[i][10];values_basal_activation.pattern=fields[i][5];values_basal_activation.neltos=fields[i][6];values_basal_activation.segments=fields[i][7].replace(/'/g,'"');values_basal_activation.percentage=fields[i][8];values_basal_activation.start=fields[i][9];values_basal_activation.user=fields[i][1];values_basal_activation.sync=fields[i][11];values_basal_activation.device=fields[i][12];if(""==values_basal_activation.pattern){Q.push(db_asocArray2delete("basal_activations",values_basal_activation,Array("id","device","user")))}else{Q.push(db_asocArray2insertorupdate(b,"basal_activations",values_basal_activation,Array("id")))}break;case"basaldef":values_basal_definition=new Array();values_basal_definition.id=fields[i][8];values_basal_definition.pattern=fields[i][5];values_basal_definition.neltos=fields[i][6];values_basal_definition.segments=fields[i][7].replace(/'/g,'"');values_basal_definition.user=fields[i][1];values_basal_definition.sync=fields[i][9];values_basal_definition.device=fields[i][10];if(0==values_basal_definition.neltos){Q.push(db_asocArray2delete("basal_definitions",values_basal_definition,Array("id","device","user")))}else{Q.push(db_asocArray2insertorupdate(b,"basal_definitions",values_basal_definition,Array("id")))}break}}if(Q.length!=0){db_execute(b,Q,g)}}function db_csv2img_arr(a){img_arr=new Array();try{fields=$.csv.toArrays(a,{delimiter:'"',separator:";"})}catch(b){return -1}for(i=0;i<fields.length;i++){switch(fields[i][4]){case"meal":if(fields[i][10]!=""){if(-1==img_arr.indexOf(fields[i][10])){img_arr.push(fields[i][10])}}break;case"event":if(fields[i][12]!=""){if(-1==img_arr.indexOf(fields[i][12])){img_arr.push(fields[i][12])}}break}}return img_arr}function db_cnu2db_convert(a){var b=new Object();hour_line=parseInt(a[1].slice(0,2),10);min_line=parseInt(a[1].slice(3,5),10);dt=new XDate(a[0]);dt.setHours(hour_line);dt.setMinutes(min_line);b.date=dt.toString("yyyy-MM-dd");b.time=dt.toString("HH:mm");b.start=dt.toString("yyyy-MM-dd HH:mm:ss");b.start=b.start.substr(0,10)+"T"+b.start.substr(11)+"Z";b.measure=parseInt("0"+a[2],10);b.units=parseInt("0"+a[13],10);racion_gr=parseInt("0"+a[15],10);racion_r=parseInt("0"+a[16],10);racion_i=parseInt("0"+a[17],10);b.ration=racion_r;if(racion_gr!=0){b.ration=racion_gr/10}if(racion_i!=0){b.ration=racion_i}b.name="";if(a[6]!="0"){b.name="D"}if(a[5]!="0"){b.name="A"}if((a[6]!="0")||(a[5]!="0")){b.name=b.name+Math.floor(hour_line/6)}if(a[4]!="0"){b.name="A0"}return b}function db_cnu2db(h,b,a,g,n){dt_now=XDate();dt0=dt_now.toUTCString("yyyy-MM-dd HH:mm:ssz");dt0=dt0.substr(0,10)+"T"+dt0.substr(11);Q=new Array();try{fields=$.csv.toArrays(b,{delimiter:","})}catch(l){return -1}for(i=1;i<fields.length;i++){if(fields[i].length!=19){continue}var f=db_cnu2db_convert(fields[i]);if(f.units!=0){values_bolus=new Array();values_bolus.id=-1;values_bolus.name=f.name;values_bolus.type="normal";values_bolus.units=f.units;values_bolus.percentage=100;values_bolus.start=f.start;values_bolus.stop=f.start;values_bolus.user=a;values_bolus.sync=dt0;values_bolus.device=g;Q.push(db_asocArray2insertorupdate(h,"bolus",values_bolus,Array("id")))}if(f.ration!=0){values_meal=new Array();values_meal.id=-1;values_meal.name=f.name;values_meal.tag="";values_meal.measure=f.ration;values_meal.start=f.start;values_meal.stop=f.start;values_meal.user=a;values_meal.image="";values_meal.sync=dt0;values_meal.device=g;Q.push(db_asocArray2insertorupdate(h,"meals",values_meal,Array("id")))}if(f.measure!=0){values_measure=new Array();values_measure.id=-1;values_measure.name=f.name;values_measure.measure=f.measure;values_measure.start=f.start;values_measure.stop=f.start;values_measure.user=a;values_measure.sync=dt0;values_measure.device=g;Q.push(db_asocArray2insertorupdate(h,"measures",values_measure,Array("id")))}}if(Q.length!=0){db_execute(h,Q,n)}}function db_js2csv(f,a,e){o="";for(k_day in f){if("basaldef"==k_day){for(var h in f[k_day]){segments_esc=f[k_day][h]["segments"].replace(/"/g,"'");o+='"'+a+'";"'+e+'";"2011-11-11";"00:00";"basaldef";"'+f[k_day][h]["pattern"]+'";"'+f[k_day][h]["neltos"]+'";"'+segments_esc+'";"'+f[k_day][h]["id"]+'";"'+f[k_day][h]["sync"]+'";"'+f[k_day][h]["device"]+'"\n'}continue}if("basalact"==k_day){continue}var b=[];for(var h in f[k_day]){keyh=h.slice(0,2);keym=h.slice(3,5);key_order=keyh*60+parseInt(keym,10);b.push([key_order,h])}b.sort(function(n,l){n=n[0];l=l[0];return n<l?-1:(n>l?1:0)});for(var g=0;g<b.length;g++){k_hour=b[g][1];for(k_type in f[k_day][k_hour]){switch(k_type){case"meal":o+='"'+a+'";"'+e+'";"'+k_day+'";"'+k_hour+'";"'+k_type+'";"'+f[k_day][k_hour][k_type]["name"]+'";"'+f[k_day][k_hour][k_type]["start"]+'";"'+f[k_day][k_hour][k_type]["stop"]+'";"'+f[k_day][k_hour][k_type]["measure"]+'";"'+f[k_day][k_hour][k_type]["tag"]+'";"'+f[k_day][k_hour][k_type]["image"]+'";"'+f[k_day][k_hour][k_type]["id"]+'";"'+f[k_day][k_hour][k_type]["sync"]+'";"'+f[k_day][k_hour][k_type]["device"]+'"\n';break;case"measure":o+='"'+a+'";"'+e+'";"'+k_day+'";"'+k_hour+'";"'+k_type+'";"'+f[k_day][k_hour][k_type]["name"]+'";"'+f[k_day][k_hour][k_type]["start"]+'";"'+f[k_day][k_hour][k_type]["stop"]+'";"'+f[k_day][k_hour][k_type]["measure"]+'";"'+f[k_day][k_hour][k_type]["id"]+'";"'+f[k_day][k_hour][k_type]["sync"]+'";"'+f[k_day][k_hour][k_type]["device"]+'"\n';break;case"bolus":o+='"'+a+'";"'+e+'";"'+k_day+'";"'+k_hour+'";"'+k_type+'";"'+f[k_day][k_hour][k_type]["name"]+'";"'+f[k_day][k_hour][k_type]["start"]+'";"'+f[k_day][k_hour][k_type]["stop"]+'";"'+f[k_day][k_hour][k_type]["units"]+'";"'+f[k_day][k_hour][k_type]["type"]+'";"'+f[k_day][k_hour][k_type]["percentage"]+'";"'+f[k_day][k_hour][k_type]["id"]+'";"'+f[k_day][k_hour][k_type]["sync"]+'";"'+f[k_day][k_hour][k_type]["device"]+'"\n';break;case"event":o+='"'+a+'";"'+e+'";"'+k_day+'";"'+k_hour+'";"'+k_type+'";"'+f[k_day][k_hour][k_type]["name"]+'";"'+f[k_day][k_hour][k_type]["start"]+'";"'+f[k_day][k_hour][k_type]["stop"]+'";"'+f[k_day][k_hour][k_type]["measure"]+'";"'+f[k_day][k_hour][k_type]["event"]+'";"'+f[k_day][k_hour][k_type]["type"]+'";"'+f[k_day][k_hour][k_type]["id"]+'";"'+f[k_day][k_hour][k_type]["image"]+'";"'+f[k_day][k_hour][k_type]["sync"]+'";"'+f[k_day][k_hour][k_type]["device"]+'"\n';break;case"basalact":segments_esc=f[k_day][k_hour][k_type]["segments"].replace(/"/g,"'");o+='"'+a+'";"'+e+'";"'+k_day+'";"'+k_hour+'";"'+k_type+'";"'+f[k_day][k_hour][k_type]["pattern"]+'";"'+f[k_day][k_hour][k_type]["neltos"]+'";"'+segments_esc+'";"'+f[k_day][k_hour][k_type]["percentage"]+'";"'+f[k_day][k_hour][k_type]["start"]+'";"'+f[k_day][k_hour][k_type]["id"]+'";"'+f[k_day][k_hour][k_type]["sync"]+'";"'+f[k_day][k_hour][k_type]["device"]+'"\n';break}}}}return o}function dbform_addtwohours(a){dt=new XDate(a);dt.addHours(ls1.aftermeal_hours);now=dt.toUTCString("yyyy-MM-dd HH:mm:ssz");now=now.substr(0,10)+"T"+now.substr(11);return now}function dbform_nextname(a){target_tags_next={A0:"D0",D0:"A1",A1:"D1",D1:"A2",A2:"D2",D2:"A3",A3:"D3",D3:"A4",A4:"A0"};return target_tags_next[a]}function dbform_fill_nextquick(e){e.elements["values_measure[name]"].value=dbform_nextname(e.elements["values_measure[name]"].value);e.elements["values_measure[measure]"].value="0";e.elements["values_measure[start]"].value=dbform_addtwohours(e.elements["values_measure[start]"].value);e.elements["values_measure[stop]"].value=e.elements["values_measure[start]"].value;var b=$("#page10gn");var a=$($("option",b).get(e.elements["values_measure[name]"].selectedIndex-1));a.attr("selected",false);var a=$($("option",b).get(((e.elements["values_measure[name]"].selectedIndex))%9));a.attr("selected",true);b.selectmenu();b.selectmenu("refresh",true);e.elements["values_meal[name]"].value=dbform_nextname(e.elements["values_meal[name]"].value);e.elements["values_meal[tag]"].value="";e.elements["values_meal[measure]"].value="0";e.elements["values_meal[start]"].value=dbform_addtwohours(e.elements["values_meal[start]"].value);e.elements["values_meal[stop]"].value=e.elements["values_meal[start]"].value;e.elements["values_meal[image]"].value="";e.elements["values_bolus[name]"].value=dbform_nextname(e.elements["values_bolus[name]"].value);e.elements["values_bolus[type]"].value="normal";e.elements["values_bolus[units]"].value="0";e.elements["values_bolus[percentage]"].value="100";e.elements["values_bolus[start]"].value=dbform_addtwohours(e.elements["values_bolus[start]"].value);e.elements["values_bolus[stop]"].value=e.elements["values_bolus[start]"].value}function dbform_fill_nextother(a){a.elements["values_other[name]"].selectedIndex=((a.elements["values_other[name]"].selectedIndex)+1)%9;a.elements["values_other[name]"].value=dbform_nextname(a.elements["values_other[name]"].value);a.elements["values_other[event]"].value="";a.elements["values_other[type]"].value="";a.elements["values_other[measure]"].value="";a.elements["values_other[start]"].value=dbform_addtwohours(a.elements["values_other[start]"].value);a.elements["values_other[stop]"].value=a.elements["values_other[start]"].value}function dbform_knobIt(h,a,b,f,g){var e=$("#x11a");if("true"!=e.attr("isKnob")){e.knob();e.attr("isKnob","true")}e.trigger("configure",{min:b,max:f,step:g,skin:"tron"});e.val(a).change();fillback=h;$("#popupx11a").popup("open")}function dbform_camera_success(a,e,b,f){if(""!=a){var g=document.querySelector(a);if(null!=g){g.value=f}}var g=document.getElementById(e);if(null!=g){g.src=f}var g=document.getElementById(b);if(null!=g){g.src=f}}function dbform_fill_segments(a,b,f){var e=new Object();e.short_v="";e.long_v="";for(i=0;i<a.length-1;i++){e.short_v+=a[i].c+" | ";e.long_v+="<tr><td align=left><font color=gray>"+(i+1)+"&nbsp;&nbsp;</font></td><td>"+a[i].h+"</td><td>&#8592;</td><td>"+a[i].c+"</td><td>&#8594;</td><td>"+a[i+1].h+"</td></tr>"}e.long_v="<table border=0>"+e.long_v+"</table>";return e}function ui_basal_fillselect(e,g,n){var a='<OPTION value=""></OPTION>';var l=0;if(typeof e.basaldef!=="undefined"){l=e.basaldef.length}for(var f=0;f<l;f++){var h=e.basaldef[f]["pattern"];var b=e.basaldef[f]["id"];if(h==n){a+='<option value="'+b+'" SELECTED>'+h+"</OPTION>"}else{a+='<option value="'+b+'">'+h+"</OPTION>"}}$(g).html("").html(a).selectmenu().selectmenu("refresh")}function ui_basal_form2def(a){var l=new Array();var g=new Object();var f=0;for(k_elto in a.elements){var e=a.elements[k_elto].name;if((typeof e==="undefined")||(e=="")){continue}var h=e.split(",");if((h[0]!="values_basaldef")&&(h[0]!="neltos")){continue}if(3==h.length){var b=h[2];var n=parseInt(h[1],10);if(typeof g[n]==="undefined"){g[n]=new Object();f++}if(b=="h"){g[n].h=a.elements[k_elto].value}else{g[n].c=a.elements[k_elto].value}}else{if(2==h.length){l[h[1]]=a.elements[k_elto].value}else{l[e]=a.elements[k_elto].value}}}g.length=f;l.segments=JSON.stringify(g);return l}function ui_basal_sections(b,a){b=parseInt(b,10);if(b==0){return""}basal_segs=JSON.parse(a);o='<center><table border=0 class="none" cellpadding=2><tr><td align=center width=50%><small><b>'+T.BEGIN+"</b></small></td><td align=center width=50%><small><b>"+T.END+"</b></small></td></tr>";for(i=0;i<b;i++){if(i<basal_segs.length){bd_i_c=basal_segs[i].c;bd_i_h=basal_segs[i].h}else{bd_i_c="0";if(0==i){bd_i_h="00:00"}else{bd_i_h="23:59"}}o+="<tr>   <td width=50% height=50% align=center>	<input id=s"+i+'t1 name="values_basaldef,'+i+",h\"               onchange=\"var values_basal = ui_basal_form2def(document.formbd);                        document.formbd.total_area.value = ui_basal_area(values_basal['segments'],'00:00','23:59');		        return false;\"               type=text size=7 data-mini=\"true\" value=\""+bd_i_h+'">	<script>	 $(function(){ $("#s'+i+"t1\").scroller({ lang: '"+ls1.lang+'\',                                                       preset: \'time\', timeFormat : "HH:ii" }); });	<\/script>    </td>    <td>&nbsp;</td> </tr><tr>    <td height=50% align=center>	<div style="border-right:1px solid #000; height:55px; width:5%"></div>    </td>   <td width=50% valign=middle>	<input name="values_basaldef,'+i+",c\"               type=number min=0 max=99 step=.01 size=3 data-mini=true data-inline=true              onchange=\"var values_basal = ui_basal_form2def(document.formbd);                      document.formbd.total_area.value = ui_basal_area(values_basal['segments'],'00:00','23:59');		          return false;\"               value=\""+bd_i_c+'">    </td></tr>'}o+="<tr>    <td align=center>	      <input id=s"+i+'t1 name="values_basaldef,'+i+',h"               type=time size=7 readonly value="23:59">    </td>    <td><br></td></tr></table></center>';return o}function ui_basal_area(w,B,a){var q=0;basal_segs=JSON.parse(w);if(0==basal_segs.length){return 0}var l=XDate("2011-11-11T"+B);var y=XDate("2011-11-11T"+a);for(m=0;m<basal_segs.length-1;m++){var e=XDate("2011-11-11T"+basal_segs[m].h);var b=XDate("2011-11-11T"+basal_segs[m+1].h);if((B>=basal_segs[m].h)&&(B<basal_segs[m+1].h)){var t=m;var h=e;var D=b;var A=parseFloat((basal_segs[m].c).replace(",","."))}if((a>basal_segs[m].h)&&(a<=basal_segs[m+1].h)){var s=m;var f=e;var p=b;var z=parseFloat((basal_segs[m].c).replace(",","."))}}if(t==s){q=l.diffHours(y)*A}else{for(var n=t+1;n<s;n++){var C=XDate("2011-11-11T"+basal_segs[n].h);var g=XDate("2011-11-11T"+basal_segs[n+1].h);q=q+C.diffHours(g)*parseFloat((basal_segs[n].c).replace(",","."))}q=q+l.diffHours(D)*A;q=q+f.diffHours(y)*z}return(q-0.005).toFixed(2)}function dbform_action_db_quick(a,e,f,b){if(-1==e.id){if(e.measure!=0){Q=db_asocArray2insert("measures",e,Array("id"))}else{Q=""}}else{Q=db_asocArray2update("measures",e,Array("id"))}if(Q!=""){a.push(Q)}if(-1==f.id){if(f.measure!=0){Q=db_asocArray2insert("meals",f,Array("id"))}else{Q=""}}else{Q=db_asocArray2update("meals",f,Array("id"))}if(Q!=""){a.push(Q)}if(-1==b.id){if(b.units!=0){Q=db_asocArray2insert("bolus",b,Array("id"))}else{Q=""}}else{Q=db_asocArray2update("bolus",b,Array("id"))}if(Q!=""){a.push(Q)}}function dbform_action_db_other(e,g,f,b){var a=new Array();if(-1==g.id){if(""!=g.event){Q=db_asocArray2insert("events",g,Array("id"))}else{Q=""}}else{Q=db_asocArray2update("events",g,Array("id"))}if(Q!=""){a.push(Q);db_execute(e,a,f,b)}}function dbform_action_db_basal_act(e,f,g,b){var a=new Array();if(-1==f.id){if(""!=f.pattern){Q=db_asocArray2insert("basal_activations",f,Array("id"))}else{Q=""}}else{Q=db_asocArray2update("basal_activations",f,Array("id"))}if(Q!=""){a.push(Q);db_execute(e,a,g,b)}}function dbform_action_db_basal_def(f,b,g,e){var a=new Array();if(-1==b.id){if(0!=b.neltos){Q=db_asocArray2insert("basal_definitions",b,Array("id"))}else{Q=""}}else{Q=db_asocArray2update("basal_definitions",b,Array("id"))}if(Q!=""){a.push(Q);db_execute(f,a,g,e)}}function dbform_action_db_user(e,b,a){Q=new Array();Q.push("UPDATE meals    SET user="+b+" WHERE user="+a);Q.push("UPDATE bolus    SET user="+b+" WHERE user="+a);Q.push("UPDATE measures SET user="+b+" WHERE user="+a);Q.push("UPDATE events   SET user="+b+" WHERE user="+a);Q.push("UPDATE basal_definitions SET user="+b+" WHERE user="+a);Q.push("UPDATE basal_activations SET user="+b+" WHERE user="+a);db_execute(e,Q)}function dbform_action_quick(e,f,g,b){dt_now=XDate();dt0=dt_now.toUTCString("yyyy-MM-dd HH:mm:ssz");dt0=dt0.substr(0,10)+"T"+dt0.substr(11);values_measure=new Array();values_measure.id=f.elements["values_measure[id]"].value;values_measure.name=f.elements["values_measure[name]"].value;values_measure.measure=f.elements["values_measure[measure]"].value;values_measure.start=f.elements["values_measure[start]"].value;values_measure.stop=f.elements["values_measure[stop]"].value;values_measure.user=f.elements["values_measure[user]"].value;values_measure.device=f.elements["values_measure[device]"].value;values_measure.sync=dt0;values_meal=new Array();values_meal.id=f.elements["values_meal[id]"].value;values_meal.name=f.elements["values_meal[name]"].value;values_meal.tag=f.elements["values_meal[tag]"].value;values_meal.measure=f.elements["values_meal[measure]"].value;values_meal.start=f.elements["values_meal[start]"].value;values_meal.stop=f.elements["values_meal[stop]"].value;values_meal.user=f.elements["values_meal[user]"].value;values_meal.image=f.elements["values_meal[image]"].value;values_meal.device=f.elements["values_meal[device]"].value;values_meal.sync=dt0;values_bolus=new Array();values_bolus.id=f.elements["values_bolus[id]"].value;values_bolus.name=f.elements["values_bolus[name]"].value;values_bolus.type=f.elements["values_bolus[type]"].value;values_bolus.units=f.elements["values_bolus[units]"].value;values_bolus.percentage=f.elements["values_bolus[percentage]"].value;values_bolus.start=f.elements["values_bolus[start]"].value;values_bolus.stop=f.elements["values_bolus[stop]"].value;values_bolus.user=f.elements["values_bolus[user]"].value;values_bolus.device=f.elements["values_bolus[device]"].value;values_bolus.sync=dt0;if(values_bolus.start!=values_bolus.stop){values_bolus.type="square"}if(100!=values_bolus.percentage){values_bolus.type="dual"}var a=new Array();dbform_action_db_quick(a,values_measure,values_meal,values_bolus);if(a.length!=0){db_execute(e,a,g,b)}}function dbform_action_other(b,e,f,a){dt_now=XDate();dt0=dt_now.toUTCString("yyyy-MM-dd HH:mm:ssz");dt0=dt0.substr(0,10)+"T"+dt0.substr(11);values_other=new Array();values_other.id=e.elements["values_other[id]"].value;values_other.name=e.elements["values_other[name]"].value;values_other.event=e.elements["values_other[event]"].value;values_other.type=e.elements["values_other[type]"].value;values_other.measure=e.elements["values_other[measure]"].value;values_other.start=e.elements["values_other[start]"].value;values_other.stop=e.elements["values_other[stop]"].value;values_other.user=e.elements["values_other[user]"].value;values_other.device=e.elements["values_other[device]"].value;values_other.image=e.elements["values_other[image]"].value;values_other.sync=dt0;dbform_action_db_other(b,values_other,f,a)}function dbform_action_basal_act(b,e,f,a){dt_now=XDate();dt0=dt_now.toUTCString("yyyy-MM-dd HH:mm:ssz");dt0=dt0.substr(0,10)+"T"+dt0.substr(11);values_basal_activation=new Array();values_basal_activation.id=e.elements["values_basal_activation[id]"].value;values_basal_activation.pattern=e.elements["values_basal_activation[pattern]"].value;values_basal_activation.neltos=e.elements["values_basal_activation[neltos]"].value;values_basal_activation.segments=e.elements["values_basal_activation[segments]"].value;values_basal_activation.percentage=e.elements["values_basal_activation[percentage]"].value;values_basal_activation.start=e.elements["values_basal_activation[start]"].value;values_basal_activation.user=e.elements["values_basal_activation[user]"].value;values_basal_activation.device=e.elements["values_basal_activation[device]"].value;values_basal_activation.sync=dt0;dbform_action_db_basal_act(b,values_basal_activation,f,a)}function dbform_action_basal_def(b,e,g,a){dt_now=XDate();dt0=dt_now.toUTCString("yyyy-MM-dd HH:mm:ssz");dt0=dt0.substr(0,10)+"T"+dt0.substr(11);var f=ui_basal_form2def(e);f.sync=dt0;dbform_action_db_basal_def(b,f,g,a)}function dbform_action_user(a,b){new_id=b.elements["values_user[newid]"].value;old_id=b.elements["values_user[oldid]"].value;b.elements["values_user[oldid]"].value=b.elements["values_user[newid]"].value;b.elements["values_user[oldlogin]"].value=b.elements["values_user[newlogin]"].value;dbform_action_db_user(a,new_id,old_id)}function dbform_action_quick_2(e,f,g,b){dt_now=XDate();dt0=dt_now.toUTCString("yyyy-MM-dd HH:mm:ssz");dt0=dt0.substr(0,10)+"T"+dt0.substr(11);values_measure=new Array();values_measure.id=f.elements["values_measure[id][before]"].value;values_measure.name=f.elements["values_measure[name][before]"].value;values_measure.measure=f.elements["values_measure[measure][before]"].value;values_measure.start=f.elements["values_measure[start][before]"].value;values_measure.stop=f.elements["values_measure[stop][before]"].value;values_measure.user=f.elements["values_measure[user][before]"].value;values_measure.device=f.elements["values_measure[device][before]"].value;values_measure.sync=dt0;values_meal=new Array();values_meal.id=f.elements["values_meal[id][before]"].value;values_meal.name=f.elements["values_meal[name][before]"].value;values_meal.tag=f.elements["values_meal[tag][before]"].value;values_meal.measure=f.elements["values_meal[measure][before]"].value;values_meal.start=f.elements["values_meal[start][before]"].value;values_meal.stop=f.elements["values_meal[stop][before]"].value;values_meal.user=f.elements["values_meal[user][before]"].value;values_meal.image=f.elements["values_meal[image][before]"].value;values_meal.device=f.elements["values_meal[device][before]"].value;values_meal.sync=dt0;values_bolus=new Array();values_bolus.id=f.elements["values_bolus[id][before]"].value;values_bolus.name=f.elements["values_bolus[name][before]"].value;values_bolus.type=f.elements["values_bolus[type][before]"].value;values_bolus.units=f.elements["values_bolus[units][before]"].value;values_bolus.percentage=f.elements["values_bolus[percentage][before]"].value;values_bolus.start=f.elements["values_bolus[start][before]"].value;values_bolus.stop=f.elements["values_bolus[stop][before]"].value;values_bolus.user=f.elements["values_bolus[user][before]"].value;values_bolus.device=f.elements["values_bolus[device][before]"].value;values_bolus.sync=dt0;if(values_bolus.start!=values_bolus.stop){values_bolus.type="square"}if(100!=values_bolus.percentage){values_bolus.type="dual"}var a=new Array();dbform_action_db_quick(a,values_measure,values_meal,values_bolus);values_measure.id=f.elements["values_measure[id][after]"].value;values_measure.name=f.elements["values_measure[name][after]"].value;values_measure.measure=f.elements["values_measure[measure][after]"].value;values_measure.start=f.elements["values_measure[start][after]"].value;values_measure.stop=f.elements["values_measure[stop][after]"].value;values_measure.user=f.elements["values_measure[user][after]"].value;values_measure.device=f.elements["values_measure[device][after]"].value;values_measure.sync=dt0;values_meal.id=f.elements["values_meal[id][after]"].value;values_meal.name=f.elements["values_meal[name][after]"].value;values_meal.tag=f.elements["values_meal[tag][after]"].value;values_meal.measure=f.elements["values_meal[measure][after]"].value;values_meal.start=f.elements["values_meal[start][after]"].value;values_meal.stop=f.elements["values_meal[stop][after]"].value;values_meal.user=f.elements["values_meal[user][after]"].value;values_meal.image=f.elements["values_meal[image][after]"].value;values_meal.device=f.elements["values_meal[device][after]"].value;values_meal.sync=dt0;values_bolus.id=f.elements["values_bolus[id][after]"].value;values_bolus.name=f.elements["values_bolus[name][after]"].value;values_bolus.type=f.elements["values_bolus[type][after]"].value;values_bolus.units=f.elements["values_bolus[units][after]"].value;values_bolus.percentage=f.elements["values_bolus[percentage][after]"].value;values_bolus.start=f.elements["values_bolus[start][after]"].value;values_bolus.stop=f.elements["values_bolus[stop][after]"].value;values_bolus.user=f.elements["values_bolus[user][after]"].value;values_bolus.device=f.elements["values_bolus[device][after]"].value;values_bolus.sync=dt0;if(values_bolus.start!=values_bolus.stop){values_bolus.type="square"}if(100!=values_bolus.percentage){values_bolus.type="dual"}dbform_action_db_quick(a,values_measure,values_meal,values_bolus);if(a.length!=0){db_execute(e,a,g,b)}}function dbform_fill0_quick(h,f,b){if(typeof f==="undefined"){dt=new XDate();dt.addHours(2);f=dt.toUTCString("yyyy-MM-dd HH:mm:ssz");f=f.substr(0,10)+"T"+f.substr(11)}if(typeof b==="undefined"){b=""}var g={"":0,A0:1,D0:2,A1:3,D1:4,A2:5,D2:6,A3:7,D3:8,A4:9};h.elements["values_measure[id]"].value=-1;h.elements["values_measure[user]"].value=ls1.user_id;h.elements["values_measure[device]"].value=ls1.device_id;h.elements["values_measure[start]"].value=f;h.elements["values_measure[start2]"].value=f;h.elements["values_measure[stop]"].value=f;h.elements["values_measure[measure]"].value=0;h.elements["values_measure[name]"].value=b;h.elements["values_measure[name]"].selectedIndex=g[b];$("#page10t1h").scroller("setValue",f,true);var e=$("#page10gn");var a=$($("option",e).get(g[b]));a.attr("selected",true);e.selectmenu();e.selectmenu("refresh",true);h.elements["values_bolus[id]"].value=-1;h.elements["values_bolus[user]"].value=ls1.user_id;h.elements["values_bolus[device]"].value=ls1.device_id;h.elements["values_bolus[type]"].value="normal";h.elements["values_bolus[units]"].value=0;h.elements["values_bolus[percentage]"].value=100;h.elements["values_bolus[start]"].value=f;h.elements["values_bolus[start2]"].value=f;h.elements["values_bolus[stop]"].value=f;h.elements["values_bolus[name]"].value=b;$("#page10t2i").scroller("setValue",f,true);$("#page10md1").hide();h.elements["values_meal[id]"].value=-1;h.elements["values_meal[user]"].value=ls1.user_id;h.elements["values_meal[device]"].value=ls1.device_id;h.elements["values_meal[start]"].value=f;h.elements["values_meal[start2]"].value=f;h.elements["values_meal[stop]"].value=f;h.elements["values_meal[name]"].value=b;h.elements["values_meal[tag]"].value="";h.elements["values_meal[measure]"].value=0;h.elements["values_meal[image]"].value="";$("#page10md2").hide();dbform_camera_success("","qimage2","qimage3","icons/empty_dish.jpg")}function dbform_fill0_other(e,b,a){if(typeof b==="undefined"){dt=new XDate();dt.addHours(2);b=dt.toUTCString("yyyy-MM-dd HH:mm:ssz");b=b.substr(0,10)+"T"+b.substr(11)}if(typeof a==="undefined"){a=""}e.elements["values_other[id]"].value=-1;e.elements["values_other[name]"].value=a;e.elements["values_other[event]"].value="";e.elements["values_other[type]"].value="";e.elements["values_other[measure]"].value="";e.elements["values_other[start]"].value=b;e.elements["values_other[start2]"].value=b;e.elements["values_other[stop]"].value=b;e.elements["values_other[user]"].value=ls1.user_id;e.elements["values_other[device]"].value=ls1.device_id;$("#t1g").scroller("setValue",b,true)}function dbform_fill0_basalactivation(b,a){if(typeof a==="undefined"){dt=new XDate();dt.addHours(2);a=dt.toUTCString("yyyy-MM-dd HH:mm:ssz");a=a.substr(0,10)+"T"+a.substr(11)}b.elements["values_basal_activation[id]"].value=-1;b.elements["values_basal_activation[user]"].value=ls1.user_id;b.elements["values_basal_activation[device]"].value=ls1.device_id;b.elements["values_basal_activation[start]"].value=a;b.elements["values_basal_activation[start2]"].value=a;b.elements["values_basal_activation[percentage]"].value=100;b.elements["values_basal_activation[neltos]"].value=0;b.elements["values_basal_activation[segments]"].value="";$("#ba_segments1").val("");$("#t1f").scroller("setValue",a,true);ui_basal_fillselect(vector_details,"#ba_pattern","standard")}function dbform_fill0_basaldefinition(e,b){if(typeof b==="undefined"){dt=new XDate();dt.addHours(2);b=dt.toUTCString("yyyy-MM-dd HH:mm:ssz");b=b.substr(0,10)+"T"+b.substr(11)}e.elements["values_basaldef,id"].value=-1;e.elements["values_basaldef,user"].value=ls1.user_id;e.elements["values_basaldef,device"].value=ls1.device_id;e.elements["values_basaldef,pattern"].value="";e.elements.total_area.value=0;e.elements.neltos.value=0;var a=$("#neltos").selectmenu().selectmenu("refresh",true);$("#basal_sections").html("").trigger("refresh");ui_basal_fillselect(vector_details,"#bd_pattern_list","")}function dbform_fill0_quick_2(f,b,a){if(typeof b==="undefined"){dt=new XDate();dt.addHours(2);b=dt.toUTCString("yyyy-MM-dd HH:mm:ssz");b=b.substr(0,10)+"T"+b.substr(11)}if(typeof a==="undefined"){a=""}var e={"":0,A0:1,D0:2,A1:3,D1:4,A2:5,D2:6,A3:7,D3:8,A4:9};f.elements["values_measure[id][before]"].value=-1;f.elements["values_measure[user][before]"].value=ls1.user_id;f.elements["values_measure[device][before]"].value=ls1.device_id;f.elements["values_measure[start][before]"].value=b;f.elements["values_measure[start2][before]"].value=b;f.elements["values_measure[stop][before]"].value=b;f.elements["values_measure[measure][before]"].value=0;f.elements["values_measure[name][before]"].value=a;f.elements["values_measure[name][before]"].selectedIndex=e[a];f.elements["values_measure[id][after]"].value=-1;f.elements["values_measure[user][after]"].value=ls1.user_id;f.elements["values_measure[device][after]"].value=ls1.device_id;f.elements["values_measure[start][after]"].value=b;f.elements["values_measure[start2][after]"].value=b;f.elements["values_measure[stop][after]"].value=b;f.elements["values_measure[measure][after]"].value=0;f.elements["values_measure[name][after]"].value=a;f.elements["values_measure[name][after]"].selectedIndex=e[a];f.elements["values_bolus[id][before]"].value=-1;f.elements["values_bolus[user][before]"].value=ls1.user_id;f.elements["values_bolus[device][before]"].value=ls1.device_id;f.elements["values_bolus[type][before]"].value="normal";f.elements["values_bolus[units][before]"].value=0;f.elements["values_bolus[percentage][before]"].value=100;f.elements["values_bolus[start][before]"].value=b;f.elements["values_bolus[start2][before]"].value=b;f.elements["values_bolus[stop][before]"].value=b;f.elements["values_bolus[name][before]"].value=a;f.elements["values_bolus[id][after]"].value=-1;f.elements["values_bolus[user][after]"].value=ls1.user_id;f.elements["values_bolus[device][after]"].value=ls1.device_id;f.elements["values_bolus[type][after]"].value="normal";f.elements["values_bolus[units][after]"].value=0;f.elements["values_bolus[percentage][after]"].value=100;f.elements["values_bolus[start][after]"].value=b;f.elements["values_bolus[start2][after]"].value=b;f.elements["values_bolus[stop][after]"].value=b;f.elements["values_bolus[name][after]"].value=a;f.elements["values_meal[id][before]"].value=-1;f.elements["values_meal[user][before]"].value=ls1.user_id;f.elements["values_meal[device][before]"].value=ls1.device_id;f.elements["values_meal[start][before]"].value=b;f.elements["values_meal[start2][before]"].value=b;f.elements["values_meal[stop][before]"].value=b;f.elements["values_meal[name][before]"].value=a;f.elements["values_meal[tag][before]"].value="";f.elements["values_meal[measure][before]"].value=0;f.elements["values_meal[image][before]"].value="";f.elements["values_meal[id][after]"].value=-1;f.elements["values_meal[user][after]"].value=ls1.user_id;f.elements["values_meal[device][after]"].value=ls1.device_id;f.elements["values_meal[start][after]"].value=b;f.elements["values_meal[start2][after]"].value=b;f.elements["values_meal[stop][after]"].value=b;f.elements["values_meal[name][after]"].value=a;f.elements["values_meal[tag][after]"].value="";f.elements["values_meal[measure][after]"].value=0;f.elements["values_meal[image][after]"].value="";dbform_camera_success("","vimage2A","vimage3A","icons/empty_dish.jpg");dbform_camera_success("","vimage2B","vimage3B","icons/empty_dish.jpg");$("#form12gsB").scroller("setValue",b,true);$("#form12gsA").scroller("setValue",b,true);$("#form12bpB").scroller("setValue",b,true);$("#form12bpA").scroller("setValue",b,true)}function dbform_fill2_quick(h,n,l,g){var e={"":0,A0:1,D0:2,A1:3,D1:4,A2:5,D2:6,A3:7,D3:8,A4:9};if(-1==g.id){if(-1==l.id){g.name=n.name;g.start2=g.start=n.start;g.stop=n.stop}else{g.name=l.name;g.start2=g.start=l.start;g.stop=l.stop}}if(-1==n.id){if(-1==l.id){n.name=g.name;n.start2=n.start=g.start;n.stop=g.stop}else{n.name=l.name;n.start2=n.start=l.start;n.stop=l.stop}}if(-1==l.id){if(-1==n.id){l.name=g.name;l.start2=l.start=g.start;l.stop=g.stop}else{l.name=n.name;l.start2=l.start=n.start;l.stop=n.stop}}dbform_fill0_quick(h,l.start,l.name);h.elements["values_measure[stop]"].value=l.stop;h.elements["values_bolus[stop]"].value=g.stop;h.elements["values_meal[stop]"].value=n.stop;if(l.id!=-1){h.elements["values_measure[id]"].value=l.id;h.elements["values_measure[user]"].value=l.user;h.elements["values_measure[device]"].value=l.device;h.elements["values_measure[measure]"].value=l.measure;h.elements["values_measure[name]"].value=l.name;h.elements["values_measure[name]"].selectedIndex=e[l.name];var b=$("#page10gn");var a=$($("option",b).get(e[l.name]));a.attr("selected",true);b.selectmenu();b.selectmenu("refresh",true)}if(g.id!=-1){h.elements["values_bolus[id]"].value=g.id;h.elements["values_bolus[user]"].value=g.user;h.elements["values_bolus[device]"].value=g.device;h.elements["values_bolus[type]"].value=g.type;h.elements["values_bolus[units]"].value=g.units;h.elements["values_bolus[percentage]"].value=g.percentage;h.elements["values_bolus[name]"].value=g.name;if(parseInt(g.units,10)!=0){$("#page10md1").show()}else{$("#page10md1").hide()}$("#page10bap1").slider("refresh")}if(n.id!=-1){h.elements["values_meal[id]"].value=n.id;h.elements["values_meal[user]"].value=n.user;h.elements["values_meal[device]"].value=n.device;h.elements["values_meal[name]"].value=n.name;h.elements["values_meal[tag]"].value=n.tag;h.elements["values_meal[measure]"].value=n.measure;h.elements["values_meal[image]"].value=n.image;if(parseInt(n.measure,10)!=0){$("#page10md2").show()}else{$("#page10md2").hide()}var f="";if(n.image!=""){f=n.image}else{f="icons/empty_dish.jpg"}dbform_camera_success("#qimage","qimage2","qimage3",f)}}function dbform_fill2_other(a,b){dbform_fill0_other(a,b.start,b.name);a.elements["values_other[stop]"].value=b.stop;if(b.id!=-1){a.elements["values_other[id]"].value=b.id;a.elements["values_other[name]"].value=b.name;a.elements["values_other[event]"].value=b.event;a.elements["values_other[type]"].value=b.type;a.elements["values_other[measure]"].value=b.measure;a.elements["values_other[user]"].value=b.user;a.elements["values_other[device]"].value=b.device;dbform_camera_success("#oimage","oimage2","oimage3",b.image)}}function dbform_fill2_basalactivation(l,h){dbform_fill0_basalactivation(l,h.start);if(h.id!=-1){l.elements["values_basal_activation[id]"].value=h.id;l.elements["values_basal_activation[user]"].value=h.user;l.elements["values_basal_activation[device]"].value=h.device;l.elements["values_basal_activation[pattern]"].value=h.pattern;l.elements["values_basal_activation[neltos]"].value=h.neltos;l.elements["values_basal_activation[segments]"].value=h.segments;l.elements["values_basal_activation[percentage]"].value=h.percentage;var a=JSON.parse(h.segments);var g=dbform_fill_segments(a);$("#ba_segments1").val(g.short_v);$("#ba_segments2").html(g.long_v);$("#bap1").slider("refresh");var e=$("#ba_pattern");var f=h.pattern;var n=$("option",e);var b=n.get(f);if(typeof b==="undefined"){b=$("<option>").attr("selected",true).attr("value",f).text(f);e.append(b)}else{$(b).attr("selected",true)}e.selectmenu();e.selectmenu("refresh",true)}}function daytag_details_name(e,b,a,f){k=new Object();k.GU="";k.MU="";k.BU="";a=parseInt(a,10);f=parseInt(f,10);for(k_hour in e){keyh=parseInt(k_hour.slice(0,2),10);keym=parseInt(k_hour.slice(3,5),10);if(keyh<a){continue}if(keyh>=f){continue}if(e[k_hour]["meal"]){if(e[k_hour]["meal"]["name"]==b){k.MU=e[k_hour]["meal"]["measure"]}}if(e[k_hour]["measure"]){if(e[k_hour]["measure"]["name"]==b){k.GU=e[k_hour]["measure"]["measure"]}}if(e[k_hour]["bolus"]){if(e[k_hour]["bolus"]["name"]==b){k.BU=e[k_hour]["bolus"]["units"]}}}k.empty=0;if((k.GU=="")&&(k.MU=="")&&(k.BU=="")){k.empty=1}return k}function daytag_details_onclick(a){tabxpn=$(a).attr("em8-tab");back_url=$(a).attr("em8-backurl");k_hour=$(a).attr("em8-khour");defdate=$(a).attr("em8-defdate");name_k=$(a).attr("em8-namek");details=vector_details[defdate];values_meal=new Object();values_measure=new Object();values_bolus=new Object();values_other=new Object();values_ba=new Object();values_meal.id=values_measure.id=values_bolus.id=values_other.id=values_ba.id="-1";values_meal.start=values_measure.start=values_bolus.start=values_other.start=values_ba.start=defdate;values_meal.stop=values_measure.stop=values_bolus.stop=values_other.stop=defdate;values_meal.start2=values_measure.start2=values_bolus.start2=values_other.start2=values_ba.start2=defdate;if(details[k_hour]["meal"]){if(details[k_hour]["meal"]["name"]==name_k){values_meal=details[k_hour]["meal"]}}if(details[k_hour]["measure"]){if(details[k_hour]["measure"]["name"]==name_k){values_measure=details[k_hour]["measure"]}}if(details[k_hour]["bolus"]){if(details[k_hour]["bolus"]["name"]==name_k){values_bolus=details[k_hour]["bolus"]}}if(details[k_hour]["event"]){values_other=details[k_hour]["event"]}if(details[k_hour]["basalact"]){values_ba=details[k_hour]["basalact"]}$.mobile.changePage("#page-quickmenu");$(tabxpn).collapsible("expand");$("a#pageqmclose").attr("href",'#" + back_url + "');$("form#form10x").attr("action",'#" + back_url + "');$("form#form11x").attr("action",'#" + back_url + "');$("form#form-qba").attr("action",'#" + back_url + "');dbform_fill2_quick(document.form10x,values_meal,values_measure,values_bolus);dbform_fill2_other(document.form11x,values_other);dbform_fill2_basalactivation(document.formqba,values_ba)}function daytag_details(l,g,f,b,h,a,n,e){GT=MT=BT=OT="";GM=MM=BM=OM="&nbsp;";a=parseInt(a,10);n=parseInt(n,10);for(k_hour in f){keyh=parseInt(k_hour.slice(0,2),10);keym=parseInt(k_hour.slice(3,5),10);if(keyh<a){continue}if(keyh>=n){continue}if(f[k_hour]["meal"]){if(f[k_hour]["meal"]["name"]==b){values_meal=f[k_hour]["meal"];MT=k_hour;MM=values_meal.measure}}if(f[k_hour]["measure"]){if(f[k_hour]["measure"]["name"]==b){values_measure=f[k_hour]["measure"];GT=k_hour;GM=values_measure.measure}}if(f[k_hour]["bolus"]){if(f[k_hour]["bolus"]["name"]==b){values_bolus=f[k_hour]["bolus"];BT=k_hour;BM=values_bolus.units}}if(f[k_hour]["other"]){if(f[k_hour]["other"]["name"]==b){values_other=f[k_hour]["other"];OT=k_hour;OM=values_other.measure}}if((GT!="")||(MT!="")||(BT!="")){break}}o=new Object();o.empty=0;if((GT=="")&&(MT=="")&&(BT=="")){o.empty=1}if(GT!=""){if(GT==MT){MT="<font size=+0>=</font>"}if(GT==BT){BT="<font size=+0>=</font>"}}else{if(BT!=""){if(BT==MT){MT="<font size=+0>=</font>"}}}o.str='  <table border=0 width=100% bgcolor=white>\n  <tr height=60%>\n    <td align=left width=20%>\n      <div type=submit class=square_button3 data-role="none">\n        <font color=blue><b>'+MM+'</b></font>&nbsp;\n      </div>\n    </td>\n    <td align=center width=60%>\n      <div type=submit class=square_button2 data-role="none">\n        <font color=black><b>'+GM+'</b></font>&nbsp;\n      </div>\n    </td>\n    <td align=right width=20%>\n      <div type=submit class=square_button1 data-role="none">\n        <font color=red><b>'+BM+'</b></font>&nbsp;\n      </div>\n    </td>\n  </tr>\n  <tr height=40%>\n    <td colspan=3 align=center>\n      <div type=submit class=square_button2 data-role="none" \n           em8-tab="#p-qm-mmb"\n           em8-backurl="'+e+'"\n           em8-defdate="'+h+'"\n           em8-khour="'+k_hour+'"\n           em8-namek="'+b+'"\n>\n      [ <b><font color=blue>'+MT+"</font>"+GT+" <font color=red>"+BT+"</font></b> ]    </div>\n    </td>\n  </tr>\n  </table>\n";return o}function daytag_errorHandler(a){var b="";switch(a.code){case FileError.QUOTA_EXCEEDED_ERR:b="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:b="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:b="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:b="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:b="INVALID_STATE_ERR";break;default:b="Unknown Error";break}console.log("Error: "+b)}function daytag_target_translation(a){if("A4"==a){return'<img height=22 src="icons/at-night.jpg">'}if("A"==a[0]){return'<img height=20 src="icons/before-meal-4.gif">'}if("D"==a[0]){return'<img height=20 src="icons/after-meal.jpg">'}return""}function daytag_summary(a,h,p,r,f){p=parseInt(p,10);r=parseInt(r,10);var q=[];for(var n in a){keyh=parseInt(n.slice(0,2),10);keym=parseInt(n.slice(3,5),10);if(keyh<p){continue}if(keyh>=r){continue}key_order=keyh*60+keym;q.push([key_order,n])}q.sort(function(t,s){t=t[0];s=s[0];return t<s?-1:(t>s?1:0)});if(0==q.length){return""}o="<table border=0 width=100%>";for(var g=0;g<q.length;g++){k_hour=q[g][1];values_meal=new Object();values_meal.id=-1;values_meal.start=h;values_measure=new Object();values_measure.id=-1;values_measure.start=h;values_bolus=new Object();values_bolus.id=-1;values_bolus.start=h;values_other=new Object();values_other.id=-1;values_other.start=h;for(k_type in a[k_hour]){if(a[k_hour][k_type]["name"]!=""){s_type="tag_"+k_type}else{s_type="untag_"+k_type}switch(s_type){case"tag_meal":case"untag_meal":values_meal=a[k_hour]["meal"];tag="";if(s_type=="tag_meal"){tag="<br><c>"+daytag_target_translation(a[k_hour][k_type]["name"])+"</c>"}associated_measure_m="&nbsp;";if(a[k_hour]["measure"]){if(a[k_hour]["measure"]["name"]==a[k_hour][k_type]["name"]){associated_measure_m=a[k_hour]["measure"]["measure"];values_measure=a[k_hour]["measure"]}}associated_bolus_u="&nbsp;";if(a[k_hour]["bolus"]){if(a[k_hour]["bolus"]["name"]==a[k_hour][k_type]["name"]){associated_bolus_u=a[k_hour]["bolus"]["units"]+"u";values_bolus=a[k_hour]["bolus"]}}img_id1="mi"+values_meal.id+"a";if((""!=values_meal.image)&&(null!=values_meal.image)){if(ls1.device_id==values_meal.device){srcimage=values_meal.image}else{srcimage=ls1.local_storage_img+"/"+values_meal.image.replace(/\\/g,"/").replace(/.*\//,"")}meal_image1="<img id="+img_id1+' rel=meals      height=80 style="max-height:512px;"      class=lazy src=icons/empty_dish.jpg data-original="'+srcimage+'">'}else{if((associated_measure_m!="&nbsp;")&&(associated_bolus_u=="&nbsp;")){srcimage="icons/empty_ta-5.png"}else{srcimage="icons/empty_dish.jpg"}meal_image1="<img id="+img_id1+' rel=meals      height=80 style="max-height:512px;"      src="'+srcimage+'">'}o=o+" <tr>\n <td align=center width=10% >\n   <font size=2><b>"+k_hour+tag+'</b></font> </td>\n <td align=center width=5% >\n      <div style="border-right:1px solid #000;height:35px;width:1px;"></div>      <div class="subtab_v">&nbsp;</div>      <div style="border-right:1px solid #000;height:35px;width:1px;"></div> </td>\n <td align=center width=88% >\n   <table border=1 class="em_table" width=100%>\n   <tr>\n   <td align=center width=15%>\n     <font size=2><b>     <div class=square_button4 data-role="none"\n           em8-tab="#p-qm-mmb"\n           em8-backurl="'+f+'"\n           em8-defdate="'+h+'"\n           em8-khour="'+k_hour+'"\n           em8-namek="'+a[k_hour][k_type]["name"]+'">\n'+a[k_hour][k_type]["measure"]+"r     </div>\n     </b></font>   </td>\n   <td align=center rowspan=3 width=85%>\n    <a href="+srcimage+'       rel=lightbox-meals        title="'+T.DESCRIPTION+": "+a[k_hour][k_type]["tag"]+"&#13;"+T.RATIONS+": "+a[k_hour][k_type]["measure"]+'">'+meal_image1+"</a>     <br><font size=2><b>"+a[k_hour][k_type]["tag"]+"</b></font>   </td>\n   </tr>\n   <tr>\n   <td align=center width=15%><font size=2><b>"+associated_measure_m+"</b></font></td>\n   </tr>\n   <tr>\n   <td align=center width=15%><font size=2><b>"+associated_bolus_u+"</b></font></td>\n   </tr>\n   </table>\n </td>\n </tr>\n";break;case"tag_bolus":case"untag_bolus":values_bolus=a[k_hour]["bolus"];if(a[k_hour][k_type]["type"]=="normal"){associated_stop="&nbsp;"}else{associated_stop=a[k_hour][k_type]["stop"]}tag="";if(s_type=="tag_bolus"){tag="<br><c>"+daytag_target_translation(a[k_hour][k_type]["name"])+"</c>"}associated_measure_m="&nbsp;";if(a[k_hour]["measure"]){if(a[k_hour]["measure"]["name"]==a[k_hour][k_type]["name"]){associated_measure_m=a[k_hour]["measure"]["measure"];values_measure=a[k_hour]["measure"]}}associated_meal_r="&nbsp;";if(a[k_hour]["meal"]){if(a[k_hour]["meal"]["name"]==a[k_hour][k_type]["name"]){associated_meal_r=a[k_hour]["meal"]["measure"];values_meal=a[k_hour]["meal"]}}if(associated_meal_r=="&nbsp;"){o=o+" <tr>\n <td align=center width=10% >\n   <font size=2><b>"+k_hour+tag+'</b></font> </td>\n <td align=center width=5% >\n      <div style="border-right:1px solid #000;height:10px;width:1px;"></div>      <div class="subtab_v">&nbsp;</div>      <div style="border-right:1px solid #000;height:10px;width:1px;"></div> </td>\n <td align=center width=88% >\n  <table border=1 class="em_table" width=100%>\n  <tr>\n  <td align=center width=15%>\n   <font size=2><b>    <div class=square_button4 data-role=none           em8-tab="#p-qm-mmb"\n           em8-backurl="'+f+'"\n           em8-defdate="'+h+'"\n           em8-khour="'+k_hour+'"\n           em8-namek="'+a[k_hour][k_type]["name"]+'">\n'+a[k_hour][k_type]["units"]+"u</div>\n   </b></font>  </td>\n  <td align=center rowspan=2 width=85%>\n    <font size=2><b>"+a[k_hour][k_type]["type"]+" &nbsp; "+a[k_hour][k_type]["percentage"]+"% <br>"+associated_stop+"</b></font>  </td>\n  </tr>\n   <tr>\n   <td align=center width=15%><font size=2><b>"+associated_measure_m+"</b></font></td>\n   </tr>\n  </table>\n </td>\n </tr>\n"}break;case"tag_measure":case"untag_measure":values_measure=a[k_hour]["measure"];tag="";if(s_type=="tag_measure"){tag="<br><c>"+daytag_target_translation(a[k_hour][k_type]["name"])+"</c>"}associated_meal_r="&nbsp;";if(a[k_hour]["meal"]){if(a[k_hour]["meal"]["name"]==a[k_hour][k_type]["name"]){associated_meal_r=a[k_hour]["meal"]["measure"];values_meal=a[k_hour]["meal"]}}associated_bolus_u="&nbsp;";if(a[k_hour]["bolus"]){if(a[k_hour]["bolus"]["name"]==a[k_hour][k_type]["name"]){associated_bolus_u=a[k_hour]["bolus"]["units"]+"u";values_bolus=a[k_hour]["bolus"]}}if((associated_meal_r=="&nbsp;")&&(associated_bolus_u=="&nbsp;")){o=o+" <tr>\n <td align=center width=10% >\n   <font size=2><b>"+k_hour+tag+'</b></font> </td>\n <td align=center width=5% >\n      <div style="border-right:1px solid #000;height:10px;width:1px;"></div>      <div class="subtab_v">&nbsp;</div>      <div style="border-right:1px solid #000;height:10px;width:1px;"></div> </td>\n <td align=center width=88% >\n  <table border=1 class="em_table" width=100%>\n  <tr>\n  <td align=center width=15%>\n   <font size=2><b>    <div class=square_button4 data-role=none           em8-tab="#p-qm-mmb"\n           em8-backurl="'+f+'"\n           em8-defdate="'+h+'"\n           em8-khour="'+k_hour+'"\n           em8-namek="'+a[k_hour][k_type]["name"]+'">\n'+a[k_hour][k_type]["measure"]+"</div>\n   </b></font>  </td>\n  <td align=center width=120>\n    &nbsp;  </td>\n  </tr>\n  </table>\n </td>\n </tr>\n"}break;case"tag_event":case"untag_event":values_other=a[k_hour][k_type];tag="";if(s_type=="tag_event"){tag="<br><c>"+daytag_target_translation(a[k_hour][k_type]["name"])+"</c>"}other_image="&nbsp;";if((""!=values_other.image)&&(null!=values_other.image)){if(ls1.device_id==values_other.device){srcimage=values_other.image}else{srcimage=ls1.local_storage_img+"/"+values_other.image.replace(/\\/g,"/").replace(/.*\//,"")}img_id1="oi"+values_other.id+"a";other_image="<a href="+srcimage+" class=lightbox-others><img id="+img_id1+' rel=others      height=80 style="max-height:512px;"      class=lazy src=icons/detective5.jpg data-original="'+srcimage+'"></a>'}o=o+" <tr>\n <td align=center width=10% >\n   <font size=2><b>"+k_hour+tag+'</b></font> </td>\n <td align=center width=5% >\n      <div style="border-right:1px solid #000;height:10px;width:1px;"></div>      <div class="subtab_v">&nbsp;</div>      <div style="border-right:1px solid #000;height:10px;width:1px;"></div> </td>\n <td align=center width=88% >\n  <table border=1 class="em_table" width=100%>\n  <tr>\n  <td align=center width=15%>\n    <font size=2><b>      <div type=submit class=square_button4 data-role=none           em8-tab="#p-qm-o"\n           em8-backurl="'+f+'"\n           em8-defdate="'+h+'"\n           em8-khour="'+k_hour+'"\n           em8-namek="'+a[k_hour][k_type]["name"]+'">\n'+a[k_hour][k_type]["event"]+"</div>\n    </b></font>  </td>\n  <td align=center rowspan=1 width=85%>\n"+other_image+"    <font size=2><b>"+a[k_hour][k_type]["type"]+" &nbsp; "+a[k_hour][k_type]["measure"]+"</b></font>  </td>\n  </tr>\n  </table>\n </td>\n </tr>\n";break;case"tag_basalact":case"untag_basalact":values_ba=a[k_hour][k_type];var b=JSON.parse(values_ba.segments);var l=dbform_fill_segments(b);var e="<a href=#b"+a[k_hour][k_type]["id"]+" data-rel=popup    data-position-to=window data-theme=d    data-inline=true data-transition=fade>    <img src=icons/faucet-2.png height=35></a><br>    <font size=2><b>"+a[k_hour][k_type]["pattern"]+" &nbsp; "+a[k_hour][k_type]["percentage"]+"%    </b></font>    <div data-role=popup id=b"+a[k_hour][k_type]["id"]+'         data-overlay-theme=b          data-corners=false data-tolerance="30,15">	      <a href=# data-rel=back data-role=button data-theme=a data-icon=delete             data-iconpos=notext class="ui-btn ui-btn-a ui-btn-icon-notext ui-btn-right ui-corner-all ui-icon-delete ui-link ui-shadow">Close</a>         <div style=\'margin: 10px;\'>      <center><font color=blue size=2><b>'+a[k_hour][k_type]["pattern"]+"</b></font></center>"+l.long_v+"         </div>    </div><br>";o=o+" <tr>\n <td align=center width=10% >\n   <font size=2><b>"+k_hour+'</b></font> </td>\n <td align=center width=5% >\n      <div style="border-right:1px solid #000;height:10px;width:1px;"></div>      <div class="subtab_v">&nbsp;</div>      <div style="border-right:1px solid #000;height:10px;width:1px;"></div> </td>\n <td align=center width=88% >\n  <table border=1 class="em_table" width=100%>\n  <tr>\n  <td align=center width=15%>\n    <font size=2><b>      <div type=submit class=square_button4 data-role=none           em8-tab="#p-qm-ba"\n           em8-backurl="'+f+'"\n           em8-defdate="'+h+'"\n           em8-khour="'+k_hour+'"\n           em8-namek="'+a[k_hour][k_type]["name"]+'">\nbasal<br>act.</div>\n    </b></font>  </td>\n  <td align=center rowspan=1 width=85%>\n'+e+"<font size=2 color=gray><b>"+l.short_v+"</b></font>  </td>\n  </tr>\n  </table>\n </td>\n </tr>\n";break}}}o+="</table>";return o}function daytag_summary_measures(b,a,e){m=0;nm=0;a=parseInt(a,10);e=parseInt(e,10);for(k_hour in b){hour_now=parseInt(k_hour.slice(0,2),10);if(hour_now<a){continue}if(hour_now>e){continue}for(k_type in b[k_hour]){if(b[k_hour][k_type]["name"]!=""){s_type="tag_"+k_type}else{s_type="untag_"+k_type}switch(s_type){case"tag_measure":m=m+parseInt(b[k_hour][k_type]["measure"],10);nm++;break;case"untag_measure":m=m+parseInt(b[k_hour][k_type]["measure"],10);nm++;break}}}if(0==nm){return 0}return(m/nm)}function daytag_summary_color(a){if(0==a){return"#f1f1f1"}o="#CCFF33";if((a>ls1.measure_range_1)&&(a<ls1.measure_range_2)){o="#FFFF99"}else{if((a>ls1.measure_range_2)&&(a<ls1.measure_range_3)){o="#FFDD11"}else{if((a>ls1.measure_range_3)){o="red"}}}return o}function daytag_update_day_month(g,l,h,e,f){var a=g+"-"+("0"+l).slice(-2)+"-"+("0"+h).slice(-2);var b=new Date(g,l,h+1);var n=b.getFullYear()+"-"+("0"+b.getMonth()).slice(-2)+"-"+("0"+b.getDate()).slice(-2);measures=0;day_info="&nbsp;";if(!((typeof e[a]==="undefined")||(Object.keys(e[a]).length==0))){measures=daytag_summary_measures(e[a],ls1.newday_hour,24);day_info=daytag_summary(e[a],a,ls1.newday_hour,24,f)}if(!((typeof e[n]==="undefined")||(Object.keys(e[n]).length==0))){measures+=daytag_summary_measures(e[n],0,ls1.newday_hour);day_info+=daytag_summary(e[n],n,0,ls1.newday_hour,f)}d=new Object();d.obj_html1=$("#di"+a);d.obj_color1=$("#h"+a);d.obj_color2=$("#s"+a);d.value_color=daytag_summary_color(measures/2);d.value_html=day_info;return d}function daytag_show_month(h,l,b,a,f,g){u='<table cellpadding=2 cellspacing=2 border=1 style="border-collapse: collapse; width:300px;">';moreinfo="";u+="<tr class=calendar-row>";for(i=0;i<a.length;i++){u+="<td class=calendar-day-head align=center><c>";u+="<font color=gray>"+a[i]+"</font>";u+="</c></td>"}u+="</tr>";dt1=new Date(h,l-1,1);running_day=dt1.getDay();if(0==running_day){running_day=7}dt2=new Date(h,l,0);days_in_month=dt2.getDate();days_in_this_week=1;day_counter=0;dates_array=new Array();u+="<tr class=calendar-row>";for(x=1;x<running_day;x++){u+="<td class=calendar-day-np>&nbsp;</td>";days_in_this_week++}for(list_day=1;list_day<=days_in_month;list_day++){k=h+"-"+("0"+l).slice(-2)+"-"+("0"+list_day).slice(-2);var e=new Date(h,l,list_day+1);k2=e.getFullYear()+"-"+("0"+e.getMonth()).slice(-2)+"-"+("0"+e.getDate()).slice(-2);currday=XDate(h,l-1,list_day,14,30,0);k0=currday.toUTCString("yyyy-MM-dd HH:mm:ssz");k0=k0.substr(0,10)+"T"+k0.substr(11);measures=0;day_info="&nbsp;";if(!((typeof f[k]==="undefined")||(Object.keys(f[k]).length==0))){measures=daytag_summary_measures(f[k],ls1.newday_hour,24);day_info=daytag_summary(f[k],k,ls1.newday_hour,24,g)}if(!((typeof f[k2]==="undefined")||(Object.keys(f[k2]).length==0))){measures+=daytag_summary_measures(f[k2],0,ls1.newday_hour);day_info+=daytag_summary(f[k2],k2,0,ls1.newday_hour,g)}c=daytag_summary_color(measures/2);u+='<td  class=calendar-day valign=middle  id="h'+k+'"     bgcolor='+c+"><center>";u+="<div class=day-number      onclick=\"$('#m"+k+"').toggle();$('img.lazy').lazyload({skip_invisible: false});return false;\">"+list_day+"</div>\n";moreinfo+='<div id="m'+k+'" align=left      style="display: none; position:relative; z-index:1; width: 100%; line-height: 18px;">\n<div id="s'+k+'"      style="background-color:'+c+'"><table border=0 width=100%><tr><td><c>'+list_day+" / "+l+" / "+h+"</c></td><td align=center>    <div data-role=none align=center style='width: 50%; text-decoration: none; border-bottom:1px dashed;'         onclick=\"      $('a#pageqmclose').attr('href','#"+g+"');      $('form#form10x').attr('action','#"+g+"');      dbform_fill0_quick(document.form10x,'"+k0+"');      dbform_fill0_other(document.form11x,'"+k0+"');      dbform_fill0_basalactivation(document.formqba,'"+k0+"');      dbform_fill0_basaldefinition(document.formbd,'"+k0+"');      $.mobile.changePage('#page-quickmenu');      $('#p-qm-mmb').collapsible('expand');\"><c>+</c></div>\n</td></tr></table></div>\n<div id=\"di"+k+'">\n'+day_info+"</div>\n</div>\n";u+="</center></td>";if(running_day==7){u+="</tr>";if((day_counter+1)!=days_in_month){u+="<tr class=calendar-row>"}running_day=0;days_in_this_week=0}days_in_this_week++;running_day++;day_counter++}if((days_in_this_week<8)&&(days_in_this_week>1)){for(x=1;x<=(8-days_in_this_week);x++){u+="<td class=calendar-day-np>&nbsp;</td>"}}u+="</tr>";u+="<tr><td colspan=7>"+moreinfo+"</td></tr>";u+="</table>";return u}function daytag_show_days(f,g,a,h,b,e){firstday=XDate(f,g-1,a,14,30,0);u='<table cellpadding=0 cellspacing=0 border=1        style="border-collapse: collapse; border-style:solid; border-color:#a0a0a0; line-height: 18px;"><tr>\n';for(currentday=0;currentday<h;currentday++){k0=firstday.toUTCString("yyyy-MM-dd HH:mm:ssz");k0=k0.substr(0,10)+"T"+k0.substr(11);k=firstday.toString("yyyy-MM-dd");firstday.addDays(1);k2=firstday.toString("yyyy-MM-dd");measures=0;day_info="&nbsp;";if(!((typeof b[k]==="undefined")||(Object.keys(b[k]).length==0))){measures=daytag_summary_measures(b[k],ls1.newday_hour,24);day_info=daytag_summary(b[k],k,ls1.newday_hour,24,e)}if(!((typeof b[k2]==="undefined")||(Object.keys(b[k2]).length==0))){measures+=daytag_summary_measures(b[k2],0,ls1.newday_hour);day_info+=daytag_summary(b[k2],k2,0,ls1.newday_hour,e)}c=daytag_summary_color(measures/2);u+='<td valign=top><table border=0 width=250><tr><td style="border-color:#a0a0a0;" bgcolor='+c+' valign=middle align=left id="h'+k+'">  <table border=0 width=100%>  <tr>   <td width=10%>&nbsp;</td>   <td width=80% align=center onclick=\'$("#di'+k+"\").toggle();'><c>"+k+"</c></td>   <td width=10% align=right>    <div data-role=none align=center style='width: 50%; text-decoration: none; border-bottom:1px dashed;'            onclick=\" $('a#pageqmclose').attr('href','#"+e+"'); $('form#form10x').attr('action','#"+e+"'); dbform_fill0_quick(document.form10x,'"+k0+"'); dbform_fill0_other(document.form11x,'"+k0+"'); dbform_fill0_basalactivation(document.formqba,'"+k0+"'); dbform_fill0_basaldefinition(document.formbd,'"+k0+"'); $.mobile.changePage('#page-quickmenu'); $('#p-qm-mmb').collapsible('expand');\"><c>+</c></div>\n  </td> </tr> </table>\n</td>\n</tr>\n<tr><td style=\"border-color:#a0a0a0;\" valign=top colspan=2><div id=di"+k+">"+day_info+"</div></td></tr></table></td>\n";firstday.addDays(-2)}u+="</tr></table>\n";return u}function daytag_table_horizontal(g,h,a,e,f,b){v="<center><table cellpadding=0 cellspacing=0 border=1 style='border-collapse: collapse; line-height: 18px;'>";v+="<tr><td>&nbsp;</td>";for(i in a){if("basaldef"==i){continue}if("basalact"==i){continue}dt=new XDate(i);dc=" <div data-role=popup  id=dc"+dt.getDate()+" data-corners=false >"+daytag_show_days(g,h,dt.getDate(),1,a,b)+"  <a href=# data-rel=back data-role=button data-theme=a data-icon=delete             data-iconpos=notext class=ui-btn-left>Close</a> </div>";v+='<td align=center style="line-height: 24px;"><a href=#dc'+dt.getDate()+" data-rel=popup style='text-decoration: none'><font color=gray>"+dt.getDate()+"</font></a>"+dc+"</td>"}v+="</tr>";for(j=0;j<e.length;j++){v+="<tr><td align=center><c><font color=gray>"+e[j]+"</font></c></td>";for(i in a){if("basaldef"==i){continue}if("basalact"==i){continue}o=daytag_details(h,g,a[i],f[j],i,ls1.newday_hour,24,b);if(o.empty==1){dt=new XDate(i);dt.addDays(1);ii=dt.toString("yyyy-MM-dd");if(a[ii]){o=daytag_details(h,g,a[ii],f[j],i,0,ls1.newday_hour,b)}}v+="<td>"+o.str+"</td>"}v+="</tr>"}v+="</table></center>";return v}function daytag_table_vertical(g,h,a,e,f,b){v="<center><table cellpadding=0 cellspacing=0 border=1 style='border-collapse: collapse; line-height: 18px;'>";v+="<tr><td>&nbsp;</td>";for(j=0;j<e.length;j++){v+="<td align=center><c><font color=gray>"+e[j]+"</font></c></td>"}v+="</tr>";for(i in a){if("basaldef"==i){continue}if("basalact"==i){continue}dt=new XDate(i);dc=" <div data-role=popup  id=dc"+dt.getDate()+">"+daytag_show_days(g,h,dt.getDate(),1,a,b)+"  <a href=# data-rel=back data-role=button data-theme=a data-icon=delete             data-iconpos=notext class=ui-btn-left>Close</a> </div>";v+='<tr><td align=center style="line-height: 24px;"><a href=#dc'+dt.getDate()+" data-rel=popup style='text-decoration: none'><font color=gray>"+dt.getDate()+"</font></a>"+dc+"</td>";for(j=0;j<e.length;j++){o=daytag_details(h,g,a[i],f[j],i,ls1.newday_hour,24,b);if(o.empty==1){dt=new XDate(i);dt.addDays(1);ii=dt.toString("yyyy-MM-dd");if(a[ii]){o=daytag_details(h,g,a[ii],f[j],i,0,ls1.newday_hour,b)}}v+="<td>"+o.str+"</td>"}v+="</tr>"}v+="</table></center>";return v}function daytag_table_compact(a,e,f,b){o="<table cellpadding=2 cellspacing=2 border=1 style='border-collapse: collapse; line-height: 22px;'>";o+="<tr><td rowspan=2>&nbsp;</td>";for(j=0;j<e.length;j++){o+="<td align=center colspan=3><c>"+e[j]+"</c></td>"}o+="</tr>";o+="<tr>";for(j=0;j<e.length;j++){o+="<td align=center><c>Gluc.</c></td><td align=center><c>Rac.</c></td><td align=center><c>Bolo</c></td>"}o+="</tr>";color="white";for(i in a){if("basaldef"==i){continue}if("basalact"==i){continue}dt=new XDate(i);ih=dt.getDate();dt.addDays(1);ii=dt.toString("yyyy-MM-dd");if("#F0F0F0"==color){color="white"}else{color="#F0F0F0"}o+="<tr bgcolor="+color+"><td align=center>"+ih+"</td>";for(j=0;j<f.length;j++){k=daytag_details_name(a[i],f[j],ls1.newday_hour,24,b);if(k.empty==1){if(a[ii]){k=daytag_details_name(a[ii],f[j],0,ls1.newday_hour,b)}}o+="<td align=center>"+k.GU+"</td><td align=center>"+k.MU+"</td><td align=center>"+k.BU+"</td>"}o+="</tr>"}o+="</table>";return o}function ensure_init_graph_visualization(){if(typeof ensure_is_init_graph==="undefined"){ensure_is_init_graph=true}else{return}$("#container0").hide();$("#container1").hide();$("#container4").hide();$("#container5").hide();$("#container6").hide();$("#container7").hide();$("#container8").hide();$("#container9").hide();$("#containerA").hide();var s=stats_byhour_getDefinition();var n=stats_bytarget_getDefinition();var p=stats_basaldef_getDefinition();var r=stats_basalact_getDefinition();var l=stats_measures_cloud_getDefinition();var w=new Highcharts.Chart(s.b1);var e=new Highcharts.Chart(s.c1);var g=new Highcharts.Chart(s.m1);var q=new Highcharts.Chart(n.b1);var a=new Highcharts.Chart(n.c1);var b=new Highcharts.Chart(n.m1);var f=new Highcharts.Chart(p);var h=new Highcharts.Chart(r);var t=new Highcharts.Chart(l)}function ui_voice(b){document.form10x.elements["values_measure[id]"].value=-1;document.form10x.elements["values_measure[measure]"].value=0;document.form10x.elements["values_meal[id]"].value=-1;document.form10x.elements["values_meal[measure]"].value=0;document.form10x.elements["values_bolus[id]"].value=-1;document.form10x.elements["values_bolus[units]"].value=0;document.form11x.elements["values_other[id]"].value=-1;dt_now=XDate();dt0=dt_now.toUTCString("yyyy-MM-dd HH:mm:ssz");dt0=dt0.substr(0,10)+"T"+dt0.substr(11);var e=b.split(" ");var a=0;while(typeof e[a]!=="undefined"&&e[a]!==null){if(e[a].match(/apunta.*/i)){a++;if(typeof e[a]!=="undefined"&&e[a]!==null){if(e[a].match(/medida.*/i)){a++;if(typeof e[a]!=="undefined"&&e[a]!==null){document.form10x.elements["values_measure[measure]"].value=parseInt(e[a],10);a++}document.form10x.elements["values_measure[start]"].value=dt0;document.form10x.elements["values_measure[stop]"].value=dt0;$("#p-qm-mmb").collapsible("expand");$.mobile.changePage("#page-quickmenu")}else{if(e[a].match(/bolo.*/i)){a++;if(typeof e[a]!=="undefined"&&e[a]!==null){document.form10x.elements["values_bolus[type]"].value=e[a];a++}if(typeof e[a]!=="undefined"&&e[a]!==null){document.form10x.elements["values_bolus[units]"].value=parseInt(e[a],10);a++}if(typeof e[a]!=="undefined"&&e[a]!==null){document.form10x.elements["values_bolus[percentage]"].value=parseInt(e[a],10);a++}document.form10x.elements["values_bolus[start]"].value=dt0;document.form10x.elements["values_bolus[stop]"].value=dt0;$("#page10md1").show();$("#p-qm-mmb").collapsible("expand");$.mobile.changePage("#page-quickmenu")}else{if(e[a].match(/comida.*/i)){a++;if(typeof e[a]!=="undefined"&&e[a]!==null){document.form10x.elements["values_meal[measure]"].value=parseInt(e[a],10);a++}document.form10x.elements["values_meal[start]"].value=dt0;document.form10x.elements["values_meal[stop]"].value=dt0;$("#page10md2").show();$("#p-qm-mmb").collapsible("expand");$.mobile.changePage("#page-quickmenu")}else{if(e[a].match(/activar.*/i)){a++;if(typeof e[a]!=="undefined"&&e[a]!==null){document.formqba.elements["values_basal_activation[pattern]"].value=e[a];a++}if(typeof e[a]!=="undefined"&&e[a]!==null){document.formqba.elements["values_basal_activation[percentage]"].value=parseInt(e[a],10);a++}document.formqba.elements["values_basal_activation[start]"].value=dt0;$("#p-qm-ba").collapsible("expand");$.mobile.changePage("#page-quickmenu")}else{a++}}}}}}else{if(e[a].match(/ve.*/i)){a++;if(typeof e[a]!=="undefined"&&e[a]!==null){if(e[a].match(/medida.*/i)){a++;ensure_init_graph_visualization();$("#container8").toggle();$("#container9").toggle();$("#containerA").toggle();$.mobile.changePage("#page24")}else{if(e[a].match(/bolo.*/i)){a++;ensure_init_graph_visualization();$("#container4").toggle();$("#container5").toggle();$.mobile.changePage("#page24")}else{if(e[a].match(/comida.*/i)){a++;ensure_init_graph_visualization();$("#container6").toggle();$("#container7").toggle();$.mobile.changePage("#page24")}else{if(e[a].match(/basal.*/i)){a++;ensure_init_graph_visualization();$("#container0").toggle();$("#container1").toggle();$.mobile.changePage("#page24")}else{if(e[a].match(/tabla.*/i)){a++;if(typeof e[a]!=="undefined"&&e[a]!==null){if(e[a].match(/horizontal.*/i)){$("#diary_div").html(daytag_table_horizontal(ls1.year,ls1.month,vector_details,target_names,target_tags,"page10")+"<br>").trigger("create")}else{if(e[a].match(/vertical.*/i)){$("#diary_div").html(daytag_table_vertical(ls1.year,ls1.month,vector_details,target_names,target_tags,"page10")+"<br>").trigger("create")}else{$("#diary_div").html(daytag_table_compact(vector_details,target_names,target_tags,"page10")+"<br>").trigger("create")}}a++}$("#diary_div").show();$.mobile.changePage("#page10")}else{if(e[a].match(/diario.*/i)){a++;if(typeof e[a]!=="undefined"&&e[a]!==null){if(e[a].match(/mes.*/i)){$("#diary_div").html(daytag_show_month(ls1.year,ls1.month,ls1.today,cal_head,vector_details,"page10")).trigger("create")}else{if(e[a].match(/semana.*/i)){$("#diary_div").html(daytag_show_days(ls1.year,ls1.month,ls1.today,7,vector_details,"page10")).trigger("create")}else{$("#diary_div").html(daytag_show_days(ls1.year,ls1.month,ls1.today,1,vector_details,"page10")).trigger("create")}}a++}$("#diary_div").show();$.mobile.changePage("#page10")}else{a++}}}}}}}}else{if(e[a].match(/configur.*/i)){a++;if(typeof e[a]!=="undefined"&&e[a]!==null){if(e[a].match(/idiom.*/i)){a++;$("#idioma").collapsible("expand");$.mobile.changePage("#page25")}else{if(e[a].match(/con.*/i)){a++;$("#conexion").collapsible("expand");$.mobile.changePage("#page25")}else{if(e[a].match(/ajus.*/i)){a++;$("#ajustes").collapsible("expand");$.mobile.changePage("#page25")}else{a++}}}}}else{a++}}}}}function stats_bytarget_getDefinition(){var l={chart:{renderTo:"container4",type:"column"},title:{text:"Bolus"},xAxis:{categories:["ADE","DDE","ACO","DCO","AME","DME","ACE","DCE","MN"]},yAxis:{min:0,title:{text:"Insulina (unidades)"}},tooltip:{formatter:function(){return""+this.x+": "+this.y+" (mg/dL)"}},plotOptions:{column:{pointPadding:0.2,borderWidth:0},series:{animation:true}}};var h={chart:{renderTo:"container6",type:"column"},title:{text:"Comidas"},xAxis:{categories:["ADE","DDE","ACO","DCO","AME","DME","ACE","DCE","MN"]},yAxis:{min:0,title:{text:"Raciones (10 gr ch.)"}},tooltip:{formatter:function(){return""+this.x+": "+this.y+" (mg/dL)"}},plotOptions:{column:{pointPadding:0.2,borderWidth:0},series:{animation:true}}};var g={chart:{renderTo:"container8",type:"column"},title:{text:"Mediciones"},xAxis:{categories:["ADE","DDE","ACO","DCO","AME","DME","ACE","DCE","MN"]},yAxis:{min:0,title:{text:"Glucosa en sangre (mg/dL)"}},tooltip:{formatter:function(){return""+this.x+": "+this.y+" (mg/dL)"}},plotOptions:{column:{pointPadding:0.2,borderWidth:0},series:{animation:true}}};l.series=new Array();h.series=new Array();g.series=new Array();for(i in vector_details){if("basaldef"==i){continue}if("basalact"==i){continue}dt=new XDate(i);dt.addDays(1);ii=dt.toString("yyyy-MM-dd");data1=new Array();data2=new Array();data3=new Array();dat_name=dt.getFullYear()+"-"+(dt.getMonth()+1)+"-"+dt.getDate();data1.name=data2.name=data3.name=dat_name;data1.data=new Array();data2.data=new Array();data3.data=new Array();for(j=0;j<target_tags.length;j++){var f=0;var e=0;var b=0;k1=daytag_details_name(vector_details[i],target_tags[j],ls1.newday_hour,24);if(vector_details[ii]){k2=daytag_details_name(vector_details[ii],target_tags[j],0,ls1.newday_hour)}if(k1.BU>0){f+=parseInt(k1.BU)}if(k2.BU>0){f+=parseInt(k2.BU)}if(k1.MU>0){e+=parseInt(k1.MU)}if(k2.MU>0){e+=parseInt(k2.MU)}if(k1.GU>0){b+=parseInt(k1.GU)}if(k2.GU>0){b+=parseInt(k2.GU)}data1.data.push(f);data2.data.push(e);data3.data.push(b)}l.series.push(data1);h.series.push(data2);g.series.push(data3)}var a=new Array();a.b1=l;a.c1=h;a.m1=g;return a}function stats_byhour_getDefinition(){var l={chart:{renderTo:"container5",type:"column"},title:{text:"Bolus"},xAxis:{categories:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]},yAxis:{min:0,title:{text:"Insulina (unidades)"}},tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>"+this.x+"~"+(parseInt(this.x,10)+1)+": "+this.y}},plotOptions:{column:{pointPadding:0.2,borderWidth:0},series:{animation:true}}};var g={chart:{renderTo:"container7",type:"column"},title:{text:"Comida"},xAxis:{categories:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]},yAxis:{min:0,title:{text:"Raciones (10 gr ch.)"}},tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>"+this.x+"~"+(parseInt(this.x,10)+1)+": "+this.y}},plotOptions:{column:{pointPadding:0.2,borderWidth:0},series:{animation:true}}};var e={chart:{renderTo:"container9",type:"column"},title:{text:"Mediciones"},xAxis:{categories:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]},yAxis:{min:0,title:{text:"Glucosa en sangre (mg/dL)"}},tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>"+this.x+"~"+(parseInt(this.x,10)+1)+": "+this.y}},plotOptions:{column:{pointPadding:0.2,borderWidth:0},series:{animation:true}}};l.series=new Array();g.series=new Array();e.series=new Array();for(i in vector_details){if("basaldef"==i){continue}if("basalact"==i){continue}var b=new Array();var h=new Array();var f=new Array();b.name=h.name=f.name=i;b.data=new Array();h.data=new Array();f.data=new Array();for(k=0;k<24;k++){b.data[k]=h.data[k]=f.data[k]=null}for(j in vector_details[i]){k=parseInt(j.match(/(\d+)/g)[0]);if(vector_details[i][j]["bolus"]){b.data[k]+=parseInt(vector_details[i][j]["bolus"]["units"])}if(vector_details[i][j]["meal"]){h.data[k]+=parseInt(vector_details[i][j]["meal"]["measure"])}if(vector_details[i][j]["measure"]){f.data[k]=parseInt(vector_details[i][j]["measure"]["measure"])}}l.series.push(b);g.series.push(h);e.series.push(f)}var a=new Array();a.b1=l;a.c1=g;a.m1=e;return a}function stats_measures_cloud_getDefinition(){var a={chart:{renderTo:"containerA",type:"scatter"},title:{text:"Mediciones"},xAxis:{categories:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]},yAxis:{min:0,title:{text:"Glucosa en sangre (mg/dL)"}},tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>"+this.x+"~"+(parseInt(this.x,10)+1)+": "+this.y}},plotOptions:{column:{pointPadding:0.2,borderWidth:0},series:{animation:true}}};a.series=new Array();data_s1=new Object();data_s1.type="spline";data_s1.name="low";data_s1.data=new Array();for(j=0;j<24;j++){data_s1.data[j]=100}a.series.push(data_s1);data_s2=new Object();data_s2.type="spline";data_s2.name="high";data_s2.data=new Array();for(j=0;j<24;j++){data_s2.data[j]=200}a.series.push(data_s2);for(i in vector_details){if("basaldef"==i){continue}if("basalact"==i){continue}data_s3=new Object();data_s3.name=i;data_s3.data=new Array();for(k=0;k<24;k++){data_s3.data[k]=null}var b=1;for(j in vector_details[i]){k=parseInt(j.match(/(\d+)/g)[0]);if(vector_details[i][j]["measure"]){data_s3.data[k]=parseInt(vector_details[i][j]["measure"]["measure"]);b=0}}if(0==b){a.series.push(data_s3)}}return a}function stats_avg_getinfo(b){var a;a=new Array();a.bolus=new Array();a.meals=new Array();a.measures=new Array();for(j=0;j<target_tags.length;j++){a.bolus[j]=new Array();a.bolus[j]["acc"]=0;a.bolus[j]["n"]=0;a.meals[j]=new Array();a.meals[j]["acc"]=0;a.meals[j]["n"]=0;a.measures[j]=new Array();a.measures[j]["acc"]=0;a.measures[j]["n"]=0}nt=new XDate();dt=new XDate(ls1.year,ls1.month-1,ls1.today);if(ls1.month!=(nt.getMonth()+1)){dt=new XDate(ls1.year,ls1.month-1,XDate.getDaysInMonth(ls1.year,ls1.month-1))}s2=dt.toString("yyyy-MM-dd");for(i=0;i<b;i++){dt.addDays(-1);s1=dt.toString("yyyy-MM-dd");for(j=0;j<target_tags.length;j++){k=daytag_details_name(vector_details[s1],target_tags[j],ls1.newday_hour,24);if(k.empty==1){if(vector_details[s2]){k=daytag_details_name(vector_details[s2],target_tags[j],0,ls1.newday_hour)}}if(k.BU>0){a.bolus[j]["acc"]+=parseInt(k.BU);a.bolus[j]["n"]+=parseInt(1)}if(k.MU>0){a.meals[j]["acc"]+=parseInt(k.MU);a.meals[j]["n"]+=parseInt(1)}if(k.GU>0){a.measures[j]["acc"]+=parseInt(k.GU);a.measures[j]["n"]+=parseInt(1)}}s2=s1}return a}function stats_avg_get(e){var a;var b;a=stats_avg_getinfo(e);td_style=" style='border-width: 1px; padding: 4px; border-style: inset; border-color: lightgray; -moz-border-radius:;' ";b="<font size=+0><table style='border-width: 1px; border-spacing: 2px; border-style: hidden; border-color: gray; border-collapse: collapse;'>";b+="<tr>";b+="<td align=center><font color=navy><b>"+e+"</b><br><font size=-1><b>days</b></font></font></td>";b+="<td align=center "+td_style+"><img height=40 src='icons/injection2.png'></td>";b+="<td align=center "+td_style+"><img height=35 src='icons/meals2.jpg'></td>";b+="<td align=center "+td_style+"><img height=40 src='icons/measurement2.png'></td>";b+="</tr>";for(j=0;j<target_tags.length;j=j+2){b+="<tr>";b+="<td align=center "+td_style+">";if(j+1<target_tags.length){b+=target_names[j]+"/"+target_names[j+1]}else{b+=target_names[j]}b+="</td>";b+="<td align=center "+td_style+">";if(a.bolus[j]["n"]!=0){b+=Math.floor(a.bolus[j]["acc"]/a.bolus[j]["n"])}else{b+="<font color=lightgray>&nbsp;.&nbsp;.&nbsp;.</font>"}if(j+1<target_tags.length){b+="&nbsp;/&nbsp;";if(a.bolus[j+1]["n"]!=0){b+=Math.floor(a.bolus[j+1]["acc"]/a.bolus[j+1]["n"])}else{b+="<font color=lightgray>.&nbsp;.&nbsp;.</font>"}}b+="</td>";b+="<td align=center "+td_style+">";if(a.meals[j]["n"]!=0){b+=Math.floor(a.meals[j]["acc"]/a.meals[j]["n"])}else{b+="<font color=lightgray>&nbsp;.&nbsp;.&nbsp;.</font>"}if(j+1<target_tags.length){b+="&nbsp;/&nbsp;";if(a.meals[j+1]["n"]!=0){b+=Math.floor(a.meals[j+1]["acc"]/a.meals[j+1]["n"])}else{b+="<font color=lightgray>.&nbsp;.&nbsp;.</font>"}}b+="</td>";b+="<td align=center "+td_style+">";if(a.measures[j]["n"]!=0){b+=Math.floor(a.measures[j]["acc"]/a.measures[j]["n"])}else{b+="<font color=lightgray>&nbsp;.&nbsp;.&nbsp;.</font>"}if(j+1<target_tags.length){b+="&nbsp;/&nbsp;";if(a.measures[j+1]["n"]!=0){b+=Math.floor(a.measures[j+1]["acc"]/a.measures[j+1]["n"])}else{b+="<font color=lightgray>.&nbsp;.&nbsp;.</font>"}}b+="</td>";b+="</tr>"}b+="</table></font>";return b}function stats_basaldef_getDefinition(){var n={chart:{renderTo:"container0",type:"spline"},title:{text:"Defined Basals"},xAxis:{type:"datetime"},yAxis:{title:{text:"Insulin (U/hour)"},min:0},tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>"+Highcharts.dateFormat("%H:%M",this.x)+": "+this.y+" U/h"}},plotOptions:{series:{animation:true}}};n.series=new Array();for(i in vector_details.basaldef){var g=vector_details.basaldef[i];var b=new Object();b.name=g.pattern;b.data=new Array();var a=JSON.parse(g.segments);for(j=0;j<a.length-1;j++){var e=parseInt(a[j].h.slice(0,2),10);var l=parseInt(a[j].h.slice(3,5),10);var h=parseFloat(a[j].c);var f=new Array(Date.UTC(ls1.year,ls1.month-1,1,e,l),h);b.data.push(f);if(j+1<a.length){var e=parseInt(a[j+1].h.slice(0,2),10);var l=parseInt(a[j+1].h.slice(3,5),10);var h=parseFloat(a[j].c);var f=new Array(Date.UTC(ls1.year,ls1.month-1,1,e,l),h);b.data.push(f)}}n.series.push(b)}return n}function stats_basalact_toHuman(a){if(a<24){return a+"h"}ndays=(parseFloat(a)/24).toFixed(0);nhours=(a-ndays*24).toFixed(1);return ndays+"d "+nhours+"h"}function stats_basalact_getDefinition(){var f={chart:{renderTo:"container1",type:"bar"},title:{text:"Basal Activations"},xAxis:{categories:["Activation<br>hours"]},yAxis:{title:{text:""},min:0},legend:{backgroundColor:"#FFFFFF",reversed:true},tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>"+stats_basalact_toHuman(this.y)}},plotOptions:{series:{stacking:"normal",animation:true}}};if(typeof vector_details.basalact==="undefined"){return f}var e=parseInt(ls1.month)-1;d_end=new XDate(ls1.year,e,XDate.getDaysInMonth(ls1.year,e));d_now=new XDate();if(d_now.getMonth()==e){d_last=d_now}else{d_last=d_end}f.series=new Array();for(i=0;i<vector_details.basalact.length;i++){var a=new Object();a.name=vector_details.basalact[i].pattern+" "+vector_details.basalact[i].percentage+"%";a.data=new Array();d1=new XDate(vector_details.basalact[i].start);if((i+1)==vector_details.basalact.length){d2=d_last}else{d2=new XDate(vector_details.basalact[i+1].start)}var b=Number(d1.diffHours(d2).toFixed(1));a.data.push(b);if(b>0){f.series.push(a)}}return f};